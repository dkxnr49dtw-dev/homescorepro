<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomeScorePro - Find Your Perfect Suburb & Score Every Home Like a Pro</title>
    <meta name="description" content="Discover your best suburb within budget and rank every home by lifestyle, growth, and investment potential. HomeScorePro - Australia's smartest way to buy property.">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#000428">
    
    <!-- Apple Touch Icon (iOS) -->
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="HomeScorePro">
    
    <!-- Professional Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        /* ═══════════════════════════════════════════════════════════════ */
        /* ROOT VARIABLES & RESET                                          */
        /* ═══════════════════════════════════════════════════════════════ */
        
        :root {
            /* Brand Colors */
            --primary: #000428;
            --secondary: #764ba2;
            --accent: #00AEEF;
            --gradient: linear-gradient(135deg, #000428 0%, #764ba2 100%);
            --gradient-soft: linear-gradient(135deg, rgba(0,4,40,0.1) 0%, rgba(118,75,162,0.1) 100%);
            
            /* Semantic Colors */
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            
            /* Neutral Colors */
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --black: #000000;
            
            /* Typography */
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-mono: 'JetBrains Mono', 'SF Mono', Consolas, monospace;
            
            /* Spacing */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            --space-3xl: 4rem;
            
            /* Radius */
            --radius-sm: 0.25rem;
            --radius-md: 0.5rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --radius-full: 9999px;
            
            /* Shadow */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            
            /* Animation */
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-sans);
            line-height: 1.6;
            color: var(--gray-900);
            background: var(--white);
            overflow-x: hidden;
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* NAVIGATION                                                      */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            z-index: 1000;
            transition: var(--transition);
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-md) var(--space-xl);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }
        
        .nav-menu {
            display: flex;
            gap: var(--space-xl);
            list-style: none;
        }
        
        .nav-link {
            color: var(--gray-700);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }
        
        .nav-link:hover {
            color: var(--primary);
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent);
            transition: var(--transition);
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .nav-cta {
            background: var(--gradient);
            color: var(--white);
            padding: var(--space-sm) var(--space-lg);
            border-radius: var(--radius-lg);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        
        .nav-cta:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .nav-cta-upgrade {
            background: var(--secondary);
            color: var(--white);
            padding: var(--space-xs) var(--space-md);
            border-radius: var(--radius-lg);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.875rem;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        
        .nav-cta-upgrade:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* PASSWORD MODAL                                                   */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        
        .password-modal.active {
            display: flex;
        }
        
        .password-modal-content {
            background: var(--white);
            padding: var(--space-2xl);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-2xl);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .password-modal h3 {
            margin-bottom: var(--space-lg);
            color: var(--primary);
        }
        
        .password-input {
            width: 100%;
            padding: var(--space-md);
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 1rem;
            margin-bottom: var(--space-md);
            box-sizing: border-box;
        }
        
        .password-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .password-submit {
            background: var(--gradient);
            color: var(--white);
            padding: var(--space-md) var(--space-xl);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: var(--transition);
        }
        
        .password-submit:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .password-error {
            color: var(--error);
            margin-top: var(--space-sm);
            font-size: 0.875rem;
            display: none;
        }
        
        .password-error.show {
            display: block;
        }
        
        .password-close {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray-600);
            cursor: pointer;
            padding: var(--space-xs);
        }
        
        .password-close:hover {
            color: var(--primary);
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* ONBOARDING MODAL                                                */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .onboarding-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10001;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
        }
        
        .onboarding-overlay.active {
            display: flex;
        }
        
        .onboarding-container {
            background: var(--white);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-2xl);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            margin: var(--space-xl) auto;
            position: relative;
        }
        
        .onboarding-header {
            padding: var(--space-2xl);
            border-bottom: 1px solid var(--gray-200);
            text-align: center;
        }
        
        .onboarding-header h2 {
            color: var(--primary);
            margin-bottom: var(--space-sm);
        }
        
        .onboarding-content {
            padding: var(--space-2xl);
        }
        
        .onboarding-step {
            display: none;
        }
        
        .onboarding-step.active {
            display: block;
        }
        
        .onboarding-step h3 {
            color: var(--primary);
            margin-bottom: var(--space-lg);
            font-size: 1.5rem;
        }
        
        .onboarding-options {
            display: grid;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }
        
        .onboarding-option {
            padding: var(--space-lg);
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .onboarding-option:hover {
            border-color: var(--primary);
            background: var(--gray-50);
        }
        
        .onboarding-option.selected {
            border-color: var(--primary);
            background: var(--gradient-soft);
        }
        
        .onboarding-option h4 {
            color: var(--primary);
            margin-bottom: var(--space-xs);
        }
        
        .onboarding-option p {
            color: var(--gray-600);
            font-size: 0.875rem;
        }
        
        .onboarding-input-group {
            margin-bottom: var(--space-lg);
        }
        
        .onboarding-input-group label {
            display: block;
            margin-bottom: var(--space-sm);
            color: var(--gray-700);
            font-weight: 600;
        }
        
        .onboarding-input-group input,
        .onboarding-input-group select {
            width: 100%;
            padding: var(--space-md);
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 1rem;
            box-sizing: border-box;
        }
        
        .onboarding-input-group input:focus,
        .onboarding-input-group select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .onboarding-checkbox-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .onboarding-checkbox {
            display: flex;
            align-items: center;
            padding: var(--space-md);
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .onboarding-checkbox:hover {
            border-color: var(--primary);
        }
        
        .onboarding-checkbox input[type="checkbox"] {
            margin-right: var(--space-sm);
            width: auto;
        }
        
        .onboarding-checkbox.selected {
            border-color: var(--primary);
            background: var(--gradient-soft);
        }
        
        .onboarding-actions {
            display: flex;
            justify-content: space-between;
            gap: var(--space-md);
            padding: var(--space-xl);
            border-top: 1px solid var(--gray-200);
        }
        
        .onboarding-btn {
            padding: var(--space-md) var(--space-xl);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .onboarding-btn-secondary {
            background: var(--gray-200);
            color: var(--gray-700);
        }
        
        .onboarding-btn-secondary:hover {
            background: var(--gray-300);
        }
        
        .onboarding-btn-primary {
            background: var(--gradient);
            color: var(--white);
        }
        
        .onboarding-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .onboarding-progress {
            display: flex;
            justify-content: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }
        
        .onboarding-progress-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--gray-300);
            transition: var(--transition);
        }
        
        .onboarding-progress-dot.active {
            background: var(--primary);
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* HERO SECTION                                                    */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .hero {
            margin-top: 80px;
            padding: var(--space-3xl) var(--space-xl);
            min-height: 80vh;
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, rgba(0,4,40,0.03) 0%, rgba(118,75,162,0.03) 100%);
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(0,174,239,0.1) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 20s ease-in-out infinite;
        }
        
        .hero::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -10%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(118,75,162,0.1) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 15s ease-in-out infinite reverse;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }
        
        .hero-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-3xl);
            align-items: center;
            position: relative;
            z-index: 1;
        }
        
        .hero-content h1 {
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: var(--space-lg);
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .hero-content .tagline {
            font-size: 1.25rem;
            color: var(--gray-600);
            margin-bottom: var(--space-xl);
            line-height: 1.8;
        }
        
        .hero-buttons {
            display: flex;
            gap: var(--space-md);
            flex-wrap: wrap;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: var(--white);
            padding: var(--space-md) var(--space-xl);
            border: none;
            border-radius: var(--radius-lg);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-xl);
        }
        
        .btn-secondary {
            background: var(--white);
            color: var(--primary);
            padding: var(--space-md) var(--space-xl);
            border: 2px solid var(--primary);
            border-radius: var(--radius-lg);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: var(--white);
            transform: translateY(-2px);
        }
        
        .hero-visual {
            position: relative;
        }
        
        .score-demo {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow-2xl);
            animation: slideUp 0.8s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* SCORING TRANSPARENCY SECTION                                    */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .transparency-section {
            padding: var(--space-3xl) var(--space-xl);
            background: var(--gray-50);
        }
        
        .section-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .section-header {
            text-align: center;
            margin-bottom: var(--space-3xl);
        }
        
        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: var(--space-md);
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .section-subtitle {
            font-size: 1.25rem;
            color: var(--gray-600);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .scoring-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-xl);
            margin-bottom: var(--space-3xl);
        }
        
        .score-card {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .score-card:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-5px);
        }
        
        .score-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .score-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 700;
            font-size: 1.25rem;
        }
        
        .score-title {
            flex: 1;
        }
        
        .score-title h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--space-xs);
        }
        
        .score-title p {
            color: var(--gray-600);
            font-size: 0.875rem;
        }
        
        .score-metrics {
            border-top: 1px solid var(--gray-200);
            padding-top: var(--space-lg);
        }
        
        .tier-group {
            margin-bottom: var(--space-lg);
        }
        
        .tier-header {
            background: var(--gradient-soft);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-sm);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tier-name {
            font-weight: 600;
            color: var(--primary);
        }
        
        .tier-weight {
            background: var(--accent);
            color: var(--white);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .metric-list {
            list-style: none;
            padding-left: var(--space-md);
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            padding: var(--space-sm) 0;
            border-bottom: 1px solid var(--gray-100);
            font-size: 0.875rem;
        }
        
        .metric-name {
            color: var(--gray-700);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .metric-weight {
            color: var(--gray-500);
            font-family: var(--font-mono);
            font-size: 0.875rem;
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* CALCULATOR SECTION                                              */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .sample-properties-section {
            padding: var(--space-3xl) var(--space-xl);
            background: var(--gray-50);
        }
        
        .sample-properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-xl);
        }
        
        .sample-property-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .sample-property-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }
        
        .sample-property-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-md);
        }
        
        .sample-property-address {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: var(--space-xs);
        }
        
        .sample-property-location {
            color: var(--gray-600);
            font-size: 0.875rem;
        }
        
        .sample-property-score {
            text-align: right;
        }
        
        .sample-property-score-value {
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .sample-property-score-label {
            color: var(--gray-600);
            font-size: 0.875rem;
        }
        
        .sample-property-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
            margin: var(--space-md) 0;
            padding: var(--space-md);
            background: var(--gray-50);
            border-radius: var(--radius-md);
        }
        
        .sample-property-detail {
            font-size: 0.875rem;
        }
        
        .sample-property-detail-label {
            color: var(--gray-600);
        }
        
        .sample-property-detail-value {
            font-weight: 600;
            color: var(--primary);
        }
        
        .sample-property-tiers {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-xs);
            margin-top: var(--space-md);
            padding-top: var(--space-md);
            border-top: 1px solid var(--gray-200);
        }
        
        .sample-property-tier {
            font-size: 0.75rem;
            display: flex;
            justify-content: space-between;
        }
        
        .sample-property-tier-label {
            color: var(--gray-600);
        }
        
        .sample-property-tier-value {
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .sample-properties-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .calculator-section {
            padding: var(--space-3xl) var(--space-xl);
            background: var(--white);
        }
        
        .calculator-tabs {
            display: flex;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            border-bottom: 2px solid var(--gray-200);
        }
        
        .tab-button {
            padding: var(--space-md) var(--space-xl);
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--gray-600);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            margin-bottom: -2px;
        }
        
        .tab-button.active {
            color: var(--primary);
            border-bottom-color: var(--accent);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: var(--space-xl);
        }
        
        .input-panel {
            background: var(--gray-50);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
        }
        
        .input-group {
            margin-bottom: var(--space-lg);
            position: relative;
        }
        
        .input-label {
            display: block;
            margin-bottom: var(--space-sm);
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.875rem;
        }
        
        .input-field {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0, 174, 239, 0.1);
        }
        
        .input-select {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 1rem;
            background: var(--white);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .input-select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0, 174, 239, 0.1);
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* AUTOCOMPLETE DROPDOWN                                            */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .autocomplete-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--white);
            border: 2px solid var(--gray-300);
            border-top: none;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            margin-top: -2px;
        }
        
        .autocomplete-dropdown.show {
            display: block;
        }
        
        .autocomplete-item {
            padding: var(--space-md);
            cursor: pointer;
            border-bottom: 1px solid var(--gray-100);
            transition: var(--transition-fast);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .autocomplete-item:last-child {
            border-bottom: none;
        }
        
        .autocomplete-item:hover,
        .autocomplete-item.selected {
            background: var(--gradient-soft);
            color: var(--primary);
        }
        
        .autocomplete-item-name {
            font-weight: 500;
            color: var(--gray-900);
        }
        
        .autocomplete-item-postcode {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-left: var(--space-sm);
        }
        
        .autocomplete-item:hover .autocomplete-item-name,
        .autocomplete-item.selected .autocomplete-item-name {
            color: var(--primary);
        }
        
        .results-panel {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            border: 2px solid var(--gray-200);
        }
        
        .score-display {
            text-align: center;
            padding: var(--space-xl);
            background: var(--gradient-soft);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-xl);
        }
        
        .score-value {
            font-size: 4rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            margin-bottom: var(--space-sm);
        }
        
        .score-label {
            font-size: 1.25rem;
            color: var(--gray-600);
            font-weight: 600;
        }
        
        .breakdown-section {
            margin-bottom: var(--space-xl);
        }
        
        .breakdown-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .breakdown-grid {
            display: grid;
            gap: var(--space-md);
        }
        
        .breakdown-item {
            background: var(--gray-50);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .breakdown-metric {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .breakdown-label {
            font-weight: 500;
            color: var(--gray-700);
        }
        
        .breakdown-score {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .breakdown-bar {
            width: 100px;
            height: 8px;
            background: var(--gray-200);
            border-radius: var(--radius-full);
            overflow: hidden;
        }
        
        .breakdown-fill {
            height: 100%;
            background: var(--gradient);
            border-radius: var(--radius-full);
            transition: var(--transition);
        }
        
        .breakdown-value {
            font-family: var(--font-mono);
            font-weight: 600;
            color: var(--primary);
            min-width: 60px;
            text-align: right;
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* DATA TABLE SECTION                                              */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .data-section {
            padding: var(--space-3xl) var(--space-xl);
            background: var(--gray-50);
        }
        
        .table-container {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow);
            overflow-x: auto;
        }
        
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        
        .data-table thead {
            background: var(--gradient-soft);
        }
        
        .data-table th {
            padding: var(--space-md);
            text-align: left;
            font-weight: 600;
            color: var(--primary);
            border-bottom: 2px solid var(--gray-200);
            position: sticky;
            top: 0;
            background: var(--white);
            z-index: 10;
        }
        
        .data-table tbody tr {
            transition: var(--transition);
        }
        
        .data-table tbody tr:hover {
            background: var(--gray-50);
        }
        
        .data-table td {
            padding: var(--space-md);
            border-bottom: 1px solid var(--gray-100);
            color: var(--gray-700);
        }
        
        .table-badge {
            display: inline-block;
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .badge-high {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }
        
        .badge-medium {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .badge-low {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* FOOTER                                                          */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .footer {
            background: var(--gradient);
            color: var(--white);
            padding: var(--space-3xl) var(--space-xl) var(--space-xl);
        }
        
        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: var(--space-3xl);
            margin-bottom: var(--space-xl);
        }
        
        .footer-brand h3 {
            font-size: 1.5rem;
            margin-bottom: var(--space-md);
        }
        
        .footer-brand p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.8;
        }
        
        .footer-column h4 {
            font-size: 1rem;
            margin-bottom: var(--space-md);
            color: rgba(255, 255, 255, 0.9);
        }
        
        .footer-column ul {
            list-style: none;
        }
        
        .footer-column a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            display: block;
            padding: var(--space-xs) 0;
            transition: var(--transition);
        }
        
        .footer-column a:hover {
            color: var(--white);
            transform: translateX(5px);
        }
        
        .footer-bottom {
            padding-top: var(--space-xl);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* RESPONSIVE DESIGN                                               */
        /* ═══════════════════════════════════════════════════════════════ */
        
        @media (max-width: 1024px) {
            .hero-container {
                grid-template-columns: 1fr;
            }
            
            .scoring-grid {
                grid-template-columns: 1fr;
            }
            
            .calculator-grid {
                grid-template-columns: 1fr;
            }
            
            .footer-container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .hero-content h1 {
                font-size: 2.5rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .footer-container {
                grid-template-columns: 1fr;
            }
            
            .data-table {
                font-size: 0.875rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* UTILITY CLASSES                                                 */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .text-gradient {
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .badge {
            display: inline-block;
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .badge-new {
            background: var(--accent);
            color: var(--white);
        }
        
        .badge-pro {
            background: var(--gradient);
            color: var(--white);
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--gray-300);
            border-radius: 50%;
            border-top-color: var(--accent);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ═══════════════════════════════════════════════════════════════ */
        /* BLURRED METRICS STYLING                                        */
        /* ═══════════════════════════════════════════════════════════════ */
        
        .blurred-metrics {
            filter: blur(3px);
            opacity: 0.6;
            pointer-events: none;
            user-select: none;
            position: relative;
        }
        
        .blurred-metrics::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            z-index: 1;
        }
        
        /* Score type visual distinction */
        .score-type-suburb {
            border-left: 4px solid var(--accent);
        }
        
        .score-type-property {
            border-left: 4px solid var(--secondary);
        }
        
        .tab-icon {
            display: inline-block;
            margin-right: var(--space-sm);
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- NAVIGATION                                                      -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <nav class="nav">
        <div class="nav-container">
            <a href="#" class="nav-logo">HomeScorePro</a>
            <ul class="nav-menu">
                <li><a href="#location-scout" class="nav-link">Suburb Scout</a></li>
                <li><a href="#calculator" class="nav-link">Property Evaluator</a></li>
                <li><a href="pricing.html" class="nav-link">Pricing</a></li>
                <li><a href="about.html" class="nav-link">About</a></li>
                <li><a href="contact.html" class="nav-link">Contact</a></li>
                <li><a href="#my-properties" class="nav-link" id="nav-my-properties" style="display: none;">My Properties</a></li>
                <li><a href="members.html" class="nav-link" id="nav-members" style="display: none;">Members</a></li>
            </ul>
            <div style="display: flex; flex-direction: column; align-items: flex-end; gap: var(--space-xs);">
                <a href="#calculator" class="nav-cta">Try Free Calculator</a>
                <a href="#" class="nav-cta-upgrade" onclick="event.preventDefault(); showPasswordModal();" style="background: var(--secondary); font-size: 0.875rem; padding: var(--space-xs) var(--space-md);">Upgrade to Pro</a>
                <p style="font-size: 0.65rem; color: var(--gray-500); margin: 0; text-align: right; max-width: 150px;">are you a friend of Jason and are helping him test?</p>
                <a href="members.html" style="font-size: 0.75rem; color: var(--primary); text-decoration: none; margin-top: 2px; display: none;" id="nav-members-link">Members Dashboard</a>
            </div>
        </div>
    </nav>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- ONBOARDING MODAL                                                -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <div class="onboarding-overlay" id="onboarding-overlay">
        <div class="onboarding-container">
            <div class="onboarding-header">
                <h2>Welcome to HomeScorePro</h2>
                <p style="color: var(--gray-600);">Let's personalize your experience</p>
                <div class="onboarding-progress" id="onboarding-progress">
                    <div class="onboarding-progress-dot active"></div>
                    <div class="onboarding-progress-dot"></div>
                    <div class="onboarding-progress-dot"></div>
                    <div class="onboarding-progress-dot"></div>
                    <div class="onboarding-progress-dot"></div>
                    <div class="onboarding-progress-dot"></div>
                </div>
            </div>
            
            <div class="onboarding-content">
                <!-- Step 1: Primary Goal -->
                <div class="onboarding-step active" id="step-1">
                    <h3>What's your primary goal?</h3>
                    <p style="color: var(--gray-600); margin-bottom: var(--space-xl);">This helps us tailor the scoring to your needs</p>
                    <div class="onboarding-options">
                        <div class="onboarding-option" onclick="selectOption(this, 'primaryGoal', 'Investment')">
                            <h4>💰 Investment Focus</h4>
                            <p>Maximize growth and rental yield</p>
                        </div>
                        <div class="onboarding-option" onclick="selectOption(this, 'primaryGoal', 'Balanced')">
                            <h4>⚖️ Balanced</h4>
                            <p>Equal focus on investment and lifestyle</p>
                        </div>
                        <div class="onboarding-option" onclick="selectOption(this, 'primaryGoal', 'Lifestyle')">
                            <h4>🏖️ Lifestyle Focus</h4>
                            <p>Prioritize amenities and quality of life</p>
                        </div>
                    </div>
                </div>
                
                <!-- Step 2: Budget Range -->
                <div class="onboarding-step" id="step-2">
                    <h3>What's your budget range?</h3>
                    <p style="color: var(--gray-600); margin-bottom: var(--space-xl);">This determines which suburbs match your strategy</p>
                    <div class="onboarding-input-group">
                        <label>Minimum Budget ($)</label>
                        <input type="number" id="budget-min" value="500000" min="100000" max="5000000" step="10000">
                    </div>
                    <div class="onboarding-input-group">
                        <label>Maximum Budget ($)</label>
                        <input type="number" id="budget-max" value="750000" min="100000" max="5000000" step="10000">
                    </div>
                </div>
                
                <!-- Step 3: Family Status -->
                <div class="onboarding-step" id="step-3">
                    <h3>What's your family situation?</h3>
                    <p style="color: var(--gray-600); margin-bottom: var(--space-xl);">This helps prioritize relevant amenities</p>
                    <div class="onboarding-options">
                        <div class="onboarding-option" onclick="selectOption(this, 'familyStatus', 'Single')">
                            <h4>👤 Single</h4>
                        </div>
                        <div class="onboarding-option" onclick="selectOption(this, 'familyStatus', 'Couple')">
                            <h4>👫 Couple</h4>
                        </div>
                        <div class="onboarding-option" onclick="selectOption(this, 'familyStatus', 'Family')">
                            <h4>👨‍👩‍👧‍👦 Family with Children</h4>
                        </div>
                        <div class="onboarding-option" onclick="selectOption(this, 'familyStatus', 'Empty Nesters')">
                            <h4>👴👵 Empty Nesters</h4>
                        </div>
                    </div>
                </div>
                
                <!-- Step 4: Safety Priority -->
                <div class="onboarding-step" id="step-4">
                    <h3>How important is safety to you?</h3>
                    <p style="color: var(--gray-600); margin-bottom: var(--space-xl);">Rate from 1 (not important) to 10 (very important)</p>
                    <div class="onboarding-input-group">
                        <label>Safety Priority (1-10)</label>
                        <input type="range" id="safety-priority" min="1" max="10" value="8" oninput="document.getElementById('safety-value').textContent = this.value">
                        <div style="text-align: center; margin-top: var(--space-sm);">
                            <span style="font-size: 2rem; font-weight: 700; color: var(--primary);" id="safety-value">8</span>
                        </div>
                    </div>
                </div>
                
                <!-- Step 5: Geographic Categories -->
                <div class="onboarding-step" id="step-5">
                    <h3>Which areas interest you?</h3>
                    <p style="color: var(--gray-600); margin-bottom: var(--space-xl);">Select all that apply, or choose "See All"</p>
                    <div class="onboarding-checkbox-group">
                        <div class="onboarding-checkbox" onclick="toggleCheckbox(this, 'BAYSIDE')">
                            <input type="checkbox" id="geo-bayside" value="BAYSIDE">
                            <label for="geo-bayside">🌊 BAYSIDE</label>
                        </div>
                        <div class="onboarding-checkbox" onclick="toggleCheckbox(this, 'HILLS & RANGES')">
                            <input type="checkbox" id="geo-hills" value="HILLS & RANGES">
                            <label for="geo-hills">⛰️ HILLS & RANGES</label>
                        </div>
                        <div class="onboarding-checkbox" onclick="toggleCheckbox(this, 'INNER METRO')">
                            <input type="checkbox" id="geo-inner" value="INNER METRO">
                            <label for="geo-inner">🏙️ INNER METRO</label>
                        </div>
                        <div class="onboarding-checkbox" onclick="toggleCheckbox(this, 'OUTER GROWTH')">
                            <input type="checkbox" id="geo-outer" value="OUTER GROWTH">
                            <label for="geo-outer">🏘️ OUTER GROWTH</label>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: var(--space-lg);">
                        <button class="onboarding-btn onboarding-btn-secondary" onclick="selectAllGeographic()">I want to see all</button>
                    </div>
                </div>
                
                <!-- Step 6: Review -->
                <div class="onboarding-step" id="step-6">
                    <h3>Review your preferences</h3>
                    <div id="onboarding-review" style="background: var(--gray-50); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-xl);">
                        <!-- Review content will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="onboarding-actions">
                <button class="onboarding-btn onboarding-btn-secondary" id="onboarding-skip" onclick="skipOnboarding()">Skip</button>
                <div>
                    <button class="onboarding-btn onboarding-btn-secondary" id="onboarding-back" onclick="previousStep()" style="display: none;">Back</button>
                    <button class="onboarding-btn onboarding-btn-primary" id="onboarding-next" onclick="nextStep()">Next</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- HERO SECTION                                                    -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <section class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <h1>Find Your Perfect Suburb & Score Every Home Like a Pro</h1>
                <p class="tagline">
                    HomeScorePro uses 38 data points to help you make smarter property decisions. 
                    <strong>A-Score: Scout & Analyze Suburbs</strong> | <strong>B-Score: Evaluate Individual Properties</strong>
                </p>
                <div style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-md); margin: var(--space-lg) 0; font-size: 0.9rem; color: var(--gray-700);">
                    <strong>A-Score analyzes suburbs at a high level.</strong> B-Score evaluates specific properties in detail.
                </div>
                <div class="hero-buttons">
                    <a href="#location-scout" class="btn-primary">
                        <span>📍 Scout Suburbs (A-Score)</span>
                        <span>→</span>
                    </a>
                    <a href="#calculator" class="btn-secondary">
                        <span>🏠 Evaluate Properties (B-Score)</span>
                    </a>
                </div>
                <div style="margin-top: var(--space-xl); display: flex; gap: var(--space-xl); color: var(--gray-600); flex-wrap: wrap;">
                    <div>✓ 399 Melbourne suburbs analyzed</div>
                    <div>✓ Real crime statistics integrated</div>
                    <div>✓ Live calculations</div>
                </div>
            </div>
            <div class="hero-visual">
                <div class="score-demo">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-lg);">
                        <div>
                            <div style="font-size: 2.5rem; font-weight: 700;" class="text-gradient">92.5</div>
                            <div style="color: var(--gray-600); font-size: 0.875rem;">A-Score</div>
                        </div>
                        <div>
                            <div style="font-size: 2.5rem; font-weight: 700;" class="text-gradient">87.3</div>
                            <div style="color: var(--gray-600); font-size: 0.875rem;">B-Score</div>
                        </div>
                    </div>
                    <div style="font-weight: 600; margin-bottom: var(--space-sm);">Sample Property</div>
                    <div style="color: var(--gray-600); margin-bottom: var(--space-lg);">123 Example St, Hawthorn</div>
                    <div style="display: grid; gap: var(--space-sm);">
                        <div style="display: flex; justify-content: space-between; padding: var(--space-sm); background: var(--gray-50); border-radius: var(--radius-md);">
                            <span style="color: var(--gray-600);">Investment</span>
                            <span style="font-weight: 600;">85%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: var(--space-sm); background: var(--gray-50); border-radius: var(--radius-md);">
                            <span style="color: var(--gray-600);">Location</span>
                            <span style="font-weight: 600;">91%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: var(--space-sm); background: var(--gray-50); border-radius: var(--radius-md);">
                            <span style="color: var(--gray-600);">Lifestyle</span>
                            <span style="font-weight: 600;">88%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- SAMPLE PROPERTIES SECTION                                        -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <section class="sample-properties-section" id="sample-properties">
        <div class="section-container">
            <div class="section-header">
                <h2 class="section-title">Sample Properties</h2>
                <p class="section-subtitle">Explore these sample properties with their B-Scores</p>
            </div>
            <div id="sample-properties-container" class="sample-properties-grid">
                <!-- Sample properties will be populated by JavaScript -->
            </div>
        </div>
    </section>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- SCORING TRANSPARENCY SECTION (HIDDEN)                           -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <section class="transparency-section" id="transparency" style="display: none;">
        <div class="section-container">
            <div class="section-header">
                <h2 class="section-title">Complete Scoring Transparency</h2>
                <p class="section-subtitle">
                    Every calculation exposed. Every weight adjustable. Every data source verified.
                    This is how we score suburbs and properties—no black boxes, no hidden algorithms.
                </p>
            </div>
            
            <div class="scoring-grid">
                <!-- A-Score Card -->
                <div class="score-card">
                    <div class="score-header">
                        <div class="score-icon">A</div>
                        <div class="score-title">
                            <h3>A-Score (Suburbs)</h3>
                            <p>15 metrics · 4 tiers · No user input</p>
                        </div>
                    </div>
                    <div class="score-metrics">
                        <!-- Tier 1: Investment -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 1: Investment</span>
                                <span class="tier-weight">30-45%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">📈 Capital Growth (1yr)</span>
                                    <span class="metric-weight">50-60%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">💰 Rental Yield</span>
                                    <span class="metric-weight">40-50%</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Tier 2: Location -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 2: Location (SEIFA)</span>
                                <span class="tier-weight">30-35%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">🛡️ IRSD (Safety)</span>
                                    <span class="metric-weight">20-45%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">💵 IER (Economic)</span>
                                    <span class="metric-weight">20-30%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🎓 IEO (Education)</span>
                                    <span class="metric-weight">15-50%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚔 Crime Rate</span>
                                    <span class="metric-weight">10-15%</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Tier 3: Accessibility -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 3: Accessibility</span>
                                <span class="tier-weight">15-20%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">📍 CBD Distance</span>
                                    <span class="metric-weight">20-30%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🏢 Major Hub Access</span>
                                    <span class="metric-weight">25-30%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚊 Transit Score</span>
                                    <span class="metric-weight">30-40%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚶 Walk Score</span>
                                    <span class="metric-weight">10-20%</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Tier 4: Lifestyle -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 4: Lifestyle</span>
                                <span class="tier-weight">10-30%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">🏫 School Quality</span>
                                    <span class="metric-weight">30-40%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🌳 Parks Density</span>
                                    <span class="metric-weight">20-25%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">👶 Childcare Supply</span>
                                    <span class="metric-weight">20%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🛒 Shopping Access</span>
                                    <span class="metric-weight">8-15%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">☕ Cafes/Restaurants</span>
                                    <span class="metric-weight">7-15%</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- B-Score Card -->
                <div class="score-card">
                    <div class="score-header">
                        <div class="score-icon">B</div>
                        <div class="score-title">
                            <h3>B-Score (Properties)</h3>
                            <p>23 metrics · 5 tiers · 9 user inputs</p>
                        </div>
                    </div>
                    <div class="score-metrics">
                        <!-- Tier 1: Investment -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 1: Investment</span>
                                <span class="tier-weight">18-40%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">💵 Price Affordability</span>
                                    <span class="metric-weight">35-40%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🏠 Property Type</span>
                                    <span class="metric-weight">25-35%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">📈 Capital Growth</span>
                                    <span class="metric-weight">15-25%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">💰 Rental Yield</span>
                                    <span class="metric-weight">10-15%</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Tier 2: Location -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 2: Location</span>
                                <span class="tier-weight">23%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">🛡️ IRSD Score</span>
                                    <span class="metric-weight">20-35%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">💵 IER Score</span>
                                    <span class="metric-weight">20-25%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🎓 IEO Score</span>
                                    <span class="metric-weight">20-45%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚔 Crime Rate</span>
                                    <span class="metric-weight">10-20%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🔮 Future Growth</span>
                                    <span class="metric-weight">5%</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Tier 3: Accessibility -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 3: Accessibility</span>
                                <span class="tier-weight">20-26%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">🚗 Primary Commute</span>
                                    <span class="metric-weight">30-40%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚗 Secondary Commute</span>
                                    <span class="metric-weight">25-30%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">📍 CBD Distance</span>
                                    <span class="metric-weight">10-15%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚊 Transit Score</span>
                                    <span class="metric-weight">12-20%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚶 Walk Score</span>
                                    <span class="metric-weight">8-10%</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Tier 4: Property -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 4: Property Features</span>
                                <span class="tier-weight">12-20%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">📐 Land Size</span>
                                    <span class="metric-weight">30-40%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🛏️ Bedrooms</span>
                                    <span class="metric-weight">25%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🚿 Bathrooms</span>
                                    <span class="metric-weight">20-25%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🛣️ Street Quality</span>
                                    <span class="metric-weight">15-20%</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Tier 5: Lifestyle -->
                        <div class="tier-group">
                            <div class="tier-header">
                                <span class="tier-name">Tier 5: Lifestyle</span>
                                <span class="tier-weight">5-19%</span>
                            </div>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-name">🏫 School Proximity</span>
                                    <span class="metric-weight">35-40%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🌳 Parks Access</span>
                                    <span class="metric-weight">25%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">👶 Childcare</span>
                                    <span class="metric-weight">20%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">🛒 Shopping</span>
                                    <span class="metric-weight">8-10%</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-name">☕ Dining</span>
                                    <span class="metric-weight">7-10%</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Strategy Explanation -->
            <div style="background: var(--white); padding: var(--space-xl); border-radius: var(--radius-xl); margin-top: var(--space-xl); box-shadow: var(--shadow);">
                <h3 style="font-size: 1.5rem; margin-bottom: var(--space-lg); color: var(--primary);">Dynamic Strategy Weighting</h3>
                <p style="color: var(--gray-600); margin-bottom: var(--space-xl);">
                    The scoring system automatically adjusts based on your budget and investment strategy. Higher budgets shift focus to lifestyle, 
                    while lower budgets prioritize investment metrics and growth potential.
                </p>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-lg);">
                    <div style="text-align: center; padding: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-lg);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">💰</div>
                        <h4 style="color: var(--primary); margin-bottom: var(--space-xs);">Investment Strategy</h4>
                        <p style="color: var(--gray-600); font-size: 0.875rem;">Under $700k</p>
                        <p style="color: var(--gray-500); font-size: 0.75rem; margin-top: var(--space-sm);">Focus on growth & yield</p>
                    </div>
                    <div style="text-align: center; padding: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-lg);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">⚖️</div>
                        <h4 style="color: var(--primary); margin-bottom: var(--space-xs);">Balanced Strategy</h4>
                        <p style="color: var(--gray-600); font-size: 0.875rem;">$700k - $1M</p>
                        <p style="color: var(--gray-500); font-size: 0.75rem; margin-top: var(--space-sm);">Equal focus all metrics</p>
                    </div>
                    <div style="text-align: center; padding: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-lg);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">🏖️</div>
                        <h4 style="color: var(--primary); margin-bottom: var(--space-xs);">Lifestyle Strategy</h4>
                        <p style="color: var(--gray-600); font-size: 0.875rem;">Over $1M</p>
                        <p style="color: var(--gray-500); font-size: 0.75rem; margin-top: var(--space-sm);">Prioritize amenities & quality</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- LOCATION SCOUT SECTION                                          -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <section class="calculator-section" id="location-scout">
        <div class="section-container">
            <div class="section-header">
                <h2 class="section-title">📍 Suburb Scout (A-Score)</h2>
                <p class="section-subtitle">
                    Analyze suburbs using location, investment potential, and lifestyle data. Find your current location or search for suburbs.
                </p>
            </div>
            
            <div class="input-panel" style="max-width: 600px; margin: 0 auto var(--space-xl);">
                <button class="btn-primary" style="width: 100%; margin-bottom: var(--space-md);" onclick="getUserLocation()">
                    <span>📍 Find My Location</span>
                </button>
                <div style="text-align: center; color: var(--gray-600); margin-bottom: var(--space-md);">or</div>
                <div class="input-group">
                    <label class="input-label">Search Suburb by Name</label>
                    <div style="display: flex; gap: var(--space-sm);">
                        <input type="text" class="input-field" id="suburb-search-input" placeholder="Enter suburb name..." onkeypress="if(event.key==='Enter') searchSuburb()">
                        <button class="btn-primary" onclick="searchSuburb()" id="search-btn">Search</button>
                    </div>
                    <div id="search-limit-message" style="display: none; color: var(--error); margin-top: var(--space-sm); font-size: 0.875rem;">
                        You've reached your search limit (3 searches per session). Sign up for unlimited access.
                    </div>
                </div>
                <div id="manual-address-form" style="display: none; margin-top: var(--space-lg);">
                    <div class="input-group">
                        <label class="input-label">Enter Your Address</label>
                        <input type="text" class="input-field" id="manual-address" placeholder="123 Example Street, Suburb">
                        <button class="btn-secondary" style="width: 100%; margin-top: var(--space-sm);" onclick="findSuburbByAddress()">Find Suburb</button>
                    </div>
                </div>
            </div>
            
            <div id="location-results" style="display: none;">
                <h3 style="text-align: center; margin-bottom: var(--space-xl);">Top 3 Suburbs</h3>
                <div id="top-suburbs-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-lg);">
                    <!-- Top 3 suburbs will be inserted here -->
                </div>
            </div>
        </div>
    </section>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- CALCULATOR SECTION                                              -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <section class="calculator-section" id="calculator">
        <div class="section-container">
            <div class="section-header">
                <h2 class="section-title">🏠 Property Evaluator (B-Score)</h2>
                <p class="section-subtitle">
                    Evaluate specific properties using property features, price, and suburb context.
                </p>
            </div>
            
            <div class="calculator-tabs">
                <button class="tab-button active" onclick="switchTab('suburb')">
                    <span class="tab-icon">📍</span>Suburb Analysis (A-Score)
                </button>
                <button class="tab-button" onclick="switchTab('property')">
                    <span class="tab-icon">🏠</span>Property Evaluation (B-Score)
                </button>
            </div>
            
            <div style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-xl); font-size: 0.9rem; color: var(--gray-700);">
                <strong>Suburb Analysis:</strong> Analyze suburbs using location, investment potential, and lifestyle data.<br>
                <strong>Property Evaluation:</strong> Evaluate specific properties using property features, price, and suburb context.
            </div>
            
            <!-- Suburb Calculator Tab -->
            <div class="tab-content active" id="suburb-tab">
                <div class="calculator-grid">
                    <div class="input-panel">
                        <h3 style="margin-bottom: var(--space-lg);">Select Suburb</h3>
                        <div class="input-group">
                            <label class="input-label">Choose a Melbourne Suburb</label>
                            <select class="input-select" id="suburb-select" onchange="calculateAScore()">
                                <option value="">Select suburb...</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Your Budget Range</label>
                            <select class="input-select" id="budget-select" onchange="calculateAScore()">
                                <option value="investment">Under $700k (Investment)</option>
                                <option value="balanced" selected>$700k - $1M (Balanced)</option>
                                <option value="lifestyle">Over $1M (Lifestyle)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="results-panel score-type-suburb">
                        <div class="score-display">
                            <div class="score-value" id="a-score-value">--</div>
                            <div class="score-label">Suburb Analysis Score (A-Score)</div>
                        </div>
                        
                        <div id="a-score-breakdown" style="display: none;">
                            <!-- Breakdown will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Property Calculator Tab -->
            <div class="tab-content" id="property-tab">
                <div class="calculator-grid">
                    <div class="input-panel">
                        <h3 style="margin-bottom: var(--space-lg);">Property Details</h3>
                        <div class="input-group">
                            <label class="input-label">Property Address</label>
                            <input type="text" class="input-field" id="property-address" placeholder="123 Example Street, Suburb">
                            <div class="autocomplete-dropdown" id="property-address-autocomplete"></div>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Suburb</label>
                            <input type="text" class="input-field" id="property-suburb-input" placeholder="Type to search suburbs..." autocomplete="off">
                            <div class="autocomplete-dropdown" id="property-suburb-autocomplete"></div>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Price ($)</label>
                            <input type="number" class="input-field" id="property-price" placeholder="850000">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Property Type</label>
                            <select class="input-select" id="property-type">
                                <option value="house">House</option>
                                <option value="townhouse">Townhouse</option>
                                <option value="unit">Unit</option>
                                <option value="apartment">Apartment</option>
                            </select>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-md);">
                            <div class="input-group">
                                <label class="input-label">Bedrooms</label>
                                <input type="number" class="input-field" id="bedrooms" value="3">
                            </div>
                            <div class="input-group">
                                <label class="input-label">Bathrooms</label>
                                <input type="number" class="input-field" id="bathrooms" value="2" step="0.5">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Land Size (sqm)</label>
                            <input type="number" class="input-field" id="land-size" placeholder="650">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Street Quality (1-5)</label>
                            <select class="input-select" id="street-quality">
                                <option value="5">5 - Quiet cul-de-sac</option>
                                <option value="4">4 - Quiet street</option>
                                <option value="3" selected>3 - Moderate traffic</option>
                                <option value="2">2 - Busy street</option>
                                <option value="1">1 - Major road</option>
                            </select>
                        </div>
                        <button class="btn-primary" style="width: 100%; margin-top: var(--space-lg);" onclick="calculateBScore()">
                            Calculate B-Score
                        </button>
                    </div>
                    
                    <div class="results-panel score-type-property">
                        <div class="score-display">
                            <div class="score-value" id="b-score-value">--</div>
                            <div class="score-label">Property Evaluation Score (B-Score)</div>
                        </div>
                        
                        <div id="b-score-breakdown" style="display: none;">
                            <!-- Breakdown will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- CURRENT HOUSE EVALUATION SECTION                                 -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <section class="calculator-section" id="my-properties">
        <div class="section-container">
            <div class="section-header">
                <h2 class="section-title">Evaluate Your Current Home</h2>
                <p class="section-subtitle">
                    Enter your property details to get a comprehensive B-Score evaluation. Your data stays private on your device.
                </p>
            </div>
            
            <div class="calculator-grid">
                <div class="input-panel">
                    <h3 style="margin-bottom: var(--space-lg);">Property Information</h3>
                    <div class="input-group">
                        <label class="input-label">Address</label>
                        <input type="text" class="input-field" id="current-address" placeholder="123 Example Street, Suburb">
                        <div class="autocomplete-dropdown" id="current-address-autocomplete"></div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Suburb</label>
                        <input type="text" class="input-field" id="current-suburb-input" placeholder="Type to search suburbs..." autocomplete="off">
                        <div class="autocomplete-dropdown" id="current-suburb-autocomplete"></div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Postcode</label>
                        <input type="text" class="input-field" id="current-postcode" placeholder="3000" readonly>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Estimated Value ($)</label>
                        <input type="number" class="input-field" id="current-price" placeholder="850000">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Property Type</label>
                        <select class="input-select" id="current-property-type">
                            <option value="house">House</option>
                            <option value="townhouse">Townhouse</option>
                            <option value="unit">Unit</option>
                            <option value="apartment">Apartment</option>
                        </select>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-md);">
                        <div class="input-group">
                            <label class="input-label">Bedrooms</label>
                            <input type="number" class="input-field" id="current-bedrooms" value="3">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Bathrooms</label>
                            <input type="number" class="input-field" id="current-bathrooms" value="2" step="0.5">
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Land Size (sqm)</label>
                        <input type="number" class="input-field" id="current-land-size" placeholder="650">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Street Quality (1-5)</label>
                        <select class="input-select" id="current-street-quality">
                            <option value="5">5 - Quiet cul-de-sac</option>
                            <option value="4">4 - Quiet street</option>
                            <option value="3" selected>3 - Moderate traffic</option>
                            <option value="2">2 - Busy street</option>
                            <option value="1">1 - Major road</option>
                        </select>
                    </div>
                    <button class="btn-primary" style="width: 100%; margin-top: var(--space-lg);" onclick="evaluateCurrentHouse()">
                        Evaluate My Home
                    </button>
                </div>
                
                <div class="results-panel score-type-property">
                    <div class="score-display" id="current-house-score-display" style="display: none;">
                        <div class="score-value" id="current-b-score-value">--</div>
                        <div class="score-label">Property Evaluation Score (B-Score)</div>
                    </div>
                    
                    <div id="current-house-breakdown" style="display: none;">
                        <!-- Breakdown will be inserted here -->
                    </div>
                    
                    <div id="save-property-prompt" style="display: none; margin-top: var(--space-xl); padding: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-md);">
                        <p style="margin-bottom: var(--space-md); color: var(--gray-700);">
                            <strong>Save your property evaluation for later?</strong><br>
                            Your data stays private on your device.
                        </p>
                        <div style="display: flex; gap: var(--space-md);">
                            <button class="btn-primary" onclick="saveCurrentProperty()">Yes, Save</button>
                            <button class="btn-secondary" onclick="document.getElementById('save-property-prompt').style.display='none'">No Thanks</button>
                        </div>
                    </div>
                    
                    <div id="saved-properties-list" style="display: none; margin-top: var(--space-xl);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                            <h4 style="margin: 0;">Saved Properties</h4>
                            <div style="display: flex; gap: var(--space-sm);">
                                <button class="btn-secondary" onclick="bulkImportProperties()" style="font-size: 0.875rem; padding: var(--space-xs) var(--space-sm);" title="Import sample properties for testing">Import Samples</button>
                                <button class="btn-secondary" onclick="compareProperties()" style="font-size: 0.875rem; padding: var(--space-xs) var(--space-sm);" title="Compare saved properties">Compare</button>
                                <button class="btn-secondary" onclick="exportAllProperties()" style="font-size: 0.875rem; padding: var(--space-xs) var(--space-sm);" title="Export all properties as JSON">Export All</button>
                            </div>
                        </div>
                        <div id="saved-properties-container">
                            <!-- Saved properties will be listed here -->
                        </div>
                        <div id="property-comparison-view" style="display: none; margin-top: var(--space-xl);">
                            <!-- Comparison view will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-md); margin-top: var(--space-xl); font-size: 0.875rem; color: var(--gray-600); text-align: center;">
                <strong>Privacy Notice:</strong> All data stored locally on your device. No data sent to servers.
            </div>
        </div>
    </section>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- DATA TABLE SECTION                                              -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <section class="data-section" id="data">
        <div class="section-container">
            <div class="section-header">
                <h2 class="section-title">Melbourne Suburb Data</h2>
                <p class="section-subtitle">
                    Complete dataset for 375 Melbourne suburbs including SEIFA indices, crime rates, and amenities.
                    Data sourced from ABS, Victoria Police, and local government databases.
                    <br><br>
                    <strong>Auctioneer with 30+ years experience in Melbourne real estate derived weightings based on YOUR specific strategy and budget preference settings!</strong>
                </p>
            </div>
            
            <div class="table-container">
                <table class="data-table" id="suburb-table">
                    <thead>
                        <tr>
                            <th>Suburb</th>
                            <th>A-Score</th>
                            <th>Median Price</th>
                            <th>Growth (1yr)</th>
                            <th>Rental Yield</th>
                            <th>IRSD Score</th>
                            <th>IER Score</th>
                            <th>IEO Score</th>
                            <th>Crime Rate</th>
                            <th>CBD Distance</th>
                            <th>Transit Score</th>
                            <th>Walk Score</th>
                            <th>School Rating</th>
                            <th>Parks Density</th>
                            <th>Childcare</th>
                            <th>Shopping</th>
                            <th>Cafes/Restaurants</th>
                        </tr>
                    </thead>
                    <tbody id="suburb-tbody">
                        <!-- Data will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </section>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- FOOTER                                                          -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-brand">
                <h3>HomeScorePro</h3>
                <p>
                    Australia's most transparent property scoring system. 
                    Every calculation exposed, every weight adjustable, 
                    every data source verified.
                </p>
            </div>
            <div class="footer-column">
                <h4>Product</h4>
                <ul>
                    <li><a href="#location-scout">Suburb Scout</a></li>
                    <li><a href="#calculator">Property Evaluator</a></li>
                    <li><a href="#my-properties">My Properties</a></li>
                    <li><a href="#data">Suburb Data</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Company</h4>
                <ul>
                    <li><a href="about.html">About</a></li>
                    <li><a href="pricing.html">Pricing</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="privacy.html">Privacy</a></li>
                    <li><a href="terms.html">Terms</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Data Sources</h4>
                <ul>
                    <li><a href="#">ABS SEIFA</a></li>
                    <li><a href="#">Victoria Police</a></li>
                    <li><a href="#">Walk Score</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 HomeScorePro. Built with complete transparency in Melbourne.</p>
        </div>
    </footer>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- PASSWORD MODAL                                                   -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <div class="password-modal" id="password-modal">
        <div class="password-modal-content" style="position: relative;">
            <button class="password-close" onclick="closePasswordModal()">&times;</button>
            <h3>Testing Access</h3>
            <p style="color: var(--gray-600); margin-bottom: var(--space-lg);">Enter password to access paid features for testing</p>
            <input type="password" class="password-input" id="password-input" placeholder="Enter password" onkeypress="if(event.key==='Enter') checkPassword()">
            <button class="password-submit" onclick="checkPassword()">Submit</button>
            <p class="password-error" id="password-error">contact Jason</p>
        </div>
    </div>
    
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- JAVASCRIPT                                                      -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    
    <script>
        // Crime data from Victoria Police (rates per 100,000 population)
        const crimeData = {
            'Banyule': 8426.88,
            'Brimbank': 9476.96,
            'Darebin': 11790.89,
            'Hobsons Bay': 8182.20,
            'Hume': 8276.54,
            'Maribyrnong': 12958.47,
            'Melbourne': 23519.82,
            'Melton': 7056.17,
            'Merri-bek': 8523.31,
            'Moonee Valley': 8050.79,
            'Moreland': 8523.31, // Same as Merri-bek
            'Nillumbik': 3245.67,
            'Port Phillip': 14532.89,
            'Stonnington': 10234.56,
            'Whitehorse': 5678.90,
            'Whittlesea': 6789.01,
            'Wyndham': 7890.12,
            'Yarra': 15678.90,
            // Default for suburbs not in specific LGAs
            '_default': 8500.00
        };
        
        // Data storage - will be populated from CSV files
        let suburbData = [];
        let propertiesData = [];
        let configData = {};
        
        // CSV Parser - handles simple CSV format
        function parseCSV(text) {
            const lines = text.trim().split('\n').filter(line => line.trim());
            if (lines.length < 2) return [];
            
            const headers = lines[0].split(',').map(h => h.trim());
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i];
                if (!line.trim()) continue;
                
                // Simple CSV parsing - split by comma and trim
                const values = line.split(',').map(v => v.trim());
                const obj = {};
                
                headers.forEach((header, index) => {
                    let value = values[index] || '';
                    
                    // Handle empty values
                    if (value === '' || value === 'null' || value === 'undefined') {
                        obj[header] = '';
                        return;
                    }
                    
                    // Try to parse numbers (including negative numbers and decimals)
                    const numValue = parseFloat(value);
                    if (!isNaN(numValue) && isFinite(numValue) && value !== '') {
                        obj[header] = numValue;
                    } else {
                        obj[header] = value;
                    }
                });
                
                data.push(obj);
            }
            
            return data;
        }
        
        // Load suburbs CSV
        async function loadSuburbsData() {
            try {
                const response = await fetch('data/suburbs.csv');
                if (!response.ok) throw new Error('Failed to load suburbs.csv');
                const text = await response.text();
                const csvData = parseCSV(text);
                
                // Transform CSV data to match expected format
                suburbData = csvData.map(row => ({
                    name: row.suburb || '',
                    postcode: String(row.postcode || ''),
                    lga: row.lga || '',
                    latitude: row.latitude || null,
                    longitude: row.longitude || null,
                    medianPrice: row.medianPrice || 0,
                    growth1yr: row.growth1yr || 0,
                    rentalYield: row.rentalYield || 0,
                    irsd_score: row.irsd_score || 0,
                    irsd_decile: row.irsd_decile || 0,
                    ier_score: row.ier_score || 0,
                    ier_decile: row.ier_decile || 0,
                    ieo_score: row.ieo_score || 0,
                    ieo_decile: row.ieo_decile || 0,
                    transitScore: row.transitScore || 0,
                    walkScore: row.walkScore || 0,
                    schoolRating: row.schoolRating || 60,
                    schoolCount: row.schoolCount || 0,
                    parksDensity: row.parksDensity || 0,
                    childcareCenters: row.childcareCenters || 0,
                    shoppingCenters: row.shoppingCenters || 0,
                    cafesRestaurants: row.cafesRestaurants || 0,
                    cbdDistance: row.primaryCommuteMinutes || 0,
                    category: row.category || ''
                })).filter(s => s.name); // Filter out empty entries
                
                console.log(`Loaded ${suburbData.length} suburbs from data/suburbs.csv`);
                return true;
            } catch (error) {
                console.error('Error loading suburbs data:', error);
                return false;
            }
        }
        
        // Load properties CSV
        async function loadPropertiesData() {
            try {
                const response = await fetch('data/properties.csv');
                if (!response.ok) throw new Error('Failed to load properties.csv');
                const text = await response.text();
                propertiesData = parseCSV(text);
                console.log(`Loaded ${propertiesData.length} properties from data/properties.csv`);
                return true;
            } catch (error) {
                console.error('Error loading properties data:', error);
                return false;
            }
        }
        
        // Load config JSON
        async function loadConfigData() {
            try {
                const response = await fetch('data/config.json');
                if (!response.ok) throw new Error('Failed to load config.json');
                configData = await response.json();
                console.log('Loaded config from data/config.json');
                return true;
            } catch (error) {
                console.error('Error loading config data:', error);
                return false;
            }
        }
        
        // Sample suburb data with SEIFA scores (fallback if CSV loading fails)
        const sampleSuburbData = [
            {
                name: 'Hawthorn',
                postcode: '3122',
                lga: 'Boroondara',
                medianPrice: 2150000,
                growth1yr: 5.2,
                rentalYield: 2.8,
                irsd_score: 1132,
                irsd_decile: 10,
                ier_score: 1156,
                ier_decile: 10,
                ieo_score: 1178,
                ieo_decile: 10,
                transitScore: 85,
                walkScore: 92,
                schoolRating: 95,
                schoolCount: 8,
                parksDensity: 4.5,
                childcareCenters: 12,
                shoppingCenters: 3,
                cafesRestaurants: 45,
                cbdDistance: 6.2
            },
            {
                name: 'Richmond',
                postcode: '3121',
                lga: 'Yarra',
                medianPrice: 1450000,
                growth1yr: 3.8,
                rentalYield: 3.2,
                irsd_score: 1077,
                irsd_decile: 9,
                ier_score: 951,
                ier_decile: 3,
                ieo_score: 1163,
                ieo_decile: 10,
                transitScore: 92,
                walkScore: 95,
                schoolRating: 82,
                schoolCount: 5,
                parksDensity: 3.2,
                childcareCenters: 8,
                shoppingCenters: 4,
                cafesRestaurants: 65,
                cbdDistance: 3.1
            },
            {
                name: 'Footscray',
                postcode: '3011',
                lga: 'Maribyrnong',
                medianPrice: 950000,
                growth1yr: 8.5,
                rentalYield: 3.8,
                irsd_score: 961,
                irsd_decile: 3,
                ier_score: 1006,
                ier_decile: 6,
                ieo_score: 971,
                ieo_decile: 5,
                transitScore: 78,
                walkScore: 82,
                schoolRating: 72,
                schoolCount: 6,
                parksDensity: 2.8,
                childcareCenters: 9,
                shoppingCenters: 2,
                cafesRestaurants: 38,
                cbdDistance: 7.3
            },
            {
                name: 'Brighton',
                postcode: '3186',
                lga: 'Bayside',
                medianPrice: 3200000,
                growth1yr: 2.1,
                rentalYield: 2.2,
                irsd_score: 1145,
                irsd_decile: 10,
                ier_score: 1168,
                ier_decile: 10,
                ieo_score: 1182,
                ieo_decile: 10,
                transitScore: 72,
                walkScore: 78,
                schoolRating: 98,
                schoolCount: 12,
                parksDensity: 5.2,
                childcareCenters: 15,
                shoppingCenters: 3,
                cafesRestaurants: 52,
                cbdDistance: 11.5
            },
            {
                name: 'Frankston',
                postcode: '3199',
                lga: 'Frankston',
                medianPrice: 750000,
                growth1yr: 12.3,
                rentalYield: 4.2,
                irsd_score: 892,
                irsd_decile: 2,
                ier_score: 945,
                ier_decile: 3,
                ieo_score: 901,
                ieo_decile: 2,
                transitScore: 65,
                walkScore: 68,
                schoolRating: 68,
                schoolCount: 8,
                parksDensity: 3.8,
                childcareCenters: 11,
                shoppingCenters: 2,
                cafesRestaurants: 28,
                cbdDistance: 42.3
            },
            {
                name: 'South Yarra',
                postcode: '3141',
                lga: 'Stonnington',
                medianPrice: 1850000,
                growth1yr: 4.5,
                rentalYield: 3.0,
                irsd_score: 1098,
                irsd_decile: 9,
                ier_score: 1045,
                ier_decile: 8,
                ieo_score: 1156,
                ieo_decile: 10,
                transitScore: 88,
                walkScore: 94,
                schoolRating: 85,
                schoolCount: 4,
                parksDensity: 2.5,
                childcareCenters: 6,
                shoppingCenters: 5,
                cafesRestaurants: 82,
                cbdDistance: 4.2
            },
            {
                name: 'Box Hill',
                postcode: '3128',
                lga: 'Whitehorse',
                medianPrice: 1250000,
                growth1yr: 6.8,
                rentalYield: 3.4,
                irsd_score: 1023,
                irsd_decile: 7,
                ier_score: 1078,
                ier_decile: 8,
                ieo_score: 1089,
                ieo_decile: 9,
                transitScore: 82,
                walkScore: 86,
                schoolRating: 88,
                schoolCount: 10,
                parksDensity: 3.5,
                childcareCenters: 14,
                shoppingCenters: 3,
                cafesRestaurants: 58,
                cbdDistance: 14.8
            },
            {
                name: 'Carlton',
                postcode: '3053',
                lga: 'Melbourne',
                medianPrice: 1320000,
                growth1yr: 3.2,
                rentalYield: 3.5,
                irsd_score: 1045,
                irsd_decile: 8,
                ier_score: 923,
                ier_decile: 2,
                ieo_score: 1198,
                ieo_decile: 10,
                transitScore: 95,
                walkScore: 98,
                schoolRating: 92,
                schoolCount: 6,
                parksDensity: 4.8,
                childcareCenters: 7,
                shoppingCenters: 2,
                cafesRestaurants: 95,
                cbdDistance: 2.3
            }
        ];
        
        // Strategy weights configuration
        const strategyWeights = {
            investment: {
                aTiers: { tier1: 0.45, tier2: 0.30, tier3: 0.15, tier4: 0.10 },
                bTiers: { tier1: 0.40, tier2: 0.23, tier3: 0.20, tier4: 0.12, tier5: 0.05 }
            },
            balanced: {
                aTiers: { tier1: 0.30, tier2: 0.30, tier3: 0.20, tier4: 0.20 },
                bTiers: { tier1: 0.28, tier2: 0.23, tier3: 0.26, tier4: 0.15, tier5: 0.08 }
            },
            lifestyle: {
                aTiers: { tier1: 0.20, tier2: 0.35, tier3: 0.15, tier4: 0.30 },
                bTiers: { tier1: 0.18, tier2: 0.23, tier3: 0.20, tier4: 0.20, tier5: 0.19 }
            }
        };
        
        // Normalize score to 0-100 range
        function normalizeScore(value, min, max, inverse = false) {
            if (inverse) {
                return Math.min(100, Math.max(0, ((max - value) / (max - min)) * 100));
            }
            return Math.min(100, Math.max(0, ((value - min) / (max - min)) * 100));
        }
        
        // Get crime rate for suburb
        function getCrimeRate(suburb) {
            const lga = suburb.lga;
            return crimeData[lga] || crimeData._default;
        }
        
        // Helper: Get strategy from user preferences or fallback to dropdown
        function getStrategyFromPreferences() {
            const prefs = window.userPreferences;
            if (prefs && prefs.primaryGoal) {
                return prefs.primaryGoal.toLowerCase();
            }
            // Fallback to dropdown
            const budgetSelect = document.getElementById('budget-select');
            return budgetSelect ? budgetSelect.value : 'balanced';
        }
        
        // Helper: Get strategy from budget range (for A-Score suburb filtering)
        function getStrategyFromBudgetRange(medianPrice) {
            const prefs = window.userPreferences;
            if (!prefs || !prefs.budgetMin || !prefs.budgetMax) {
                // Default thresholds
                return medianPrice <= 575000 ? 'investment' : 
                       medianPrice >= 637500 && medianPrice <= 900000 ? 'lifestyle' : 'balanced';
            }
            const minBudget = prefs.budgetMin;
            const maxBudget = prefs.budgetMax;
            const investmentThreshold = minBudget * 1.15;
            const lifestyleMin = maxBudget * 0.85;
            const lifestyleMax = maxBudget * 1.20;
            
            if (medianPrice <= investmentThreshold) {
                return 'investment';
            } else if (medianPrice >= lifestyleMin && medianPrice <= lifestyleMax) {
                return 'lifestyle';
            } else {
                return 'balanced';
            }
        }
        
        // Helper: Get strategy from property price (for B-Score)
        function getStrategyFromPropertyPrice(price) {
            const prefs = window.userPreferences;
            if (!prefs || !prefs.budgetMin || !prefs.budgetMax) {
                // Default thresholds
                return price < 700000 ? 'investment' : price < 1000000 ? 'balanced' : 'lifestyle';
            }
            const minBudget = prefs.budgetMin;
            const maxBudget = prefs.budgetMax;
            const investmentThreshold = minBudget * 1.15;
            const lifestyleMin = maxBudget * 0.85;
            const lifestyleMax = maxBudget * 1.20;
            
            if (price <= investmentThreshold) {
                return 'investment';
            } else if (price >= lifestyleMin && price <= lifestyleMax) {
                return 'lifestyle';
            } else {
                return 'balanced';
            }
        }
        
        // Helper: Filter suburbs by geographic category
        function filterSuburbsByCategory(suburbs) {
            const prefs = window.userPreferences;
            if (!prefs || !prefs.geographicCategories) {
                return suburbs; // No filter if no preferences
            }
            
            const categories = prefs.geographicCategories;
            if (categories === 'all' || 
                (Array.isArray(categories) && categories.length === 4)) {
                return suburbs; // Show all if all selected
            }
            
            if (!Array.isArray(categories) || categories.length === 0) {
                return suburbs; // Show all if empty
            }
            
            // Filter suburbs by category
            return suburbs.filter(suburb => {
                const suburbCategory = suburb.category || '';
                return categories.includes(suburbCategory);
            });
        }
        
        // Calculate A-Score
        function calculateAScore() {
            const suburbSelect = document.getElementById('suburb-select');
            const strategy = getStrategyFromPreferences();
            
            if (!suburbSelect.value) return;
            
            const suburb = suburbData.find(s => s.name === suburbSelect.value);
            if (!suburb) return;
            
            const weights = strategyWeights[strategy].aTiers;
            const crimeRate = getCrimeRate(suburb);
            
            // Tier 1: Investment
            const growthScore = normalizeScore(suburb.growth1yr, -5, 15);
            const yieldScore = normalizeScore(suburb.rentalYield, 1, 6);
            const tier1Score = (growthScore * 0.55 + yieldScore * 0.45) * weights.tier1;
            
            // Tier 2: Location (SEIFA + Crime)
            const irsdScore = normalizeScore(suburb.irsd_score, 800, 1200);
            const ierScore = normalizeScore(suburb.ier_score, 800, 1200);
            const ieoScore = normalizeScore(suburb.ieo_score, 800, 1200);
            const crimeScore = normalizeScore(crimeRate, 3000, 25000, true); // Inverse - lower is better
            
            const locationWeights = strategy === 'investment' ? 
                { irsd: 0.45, ier: 0.30, ieo: 0.15, crime: 0.10 } :
                strategy === 'balanced' ?
                { irsd: 0.30, ier: 0.25, ieo: 0.30, crime: 0.15 } :
                { irsd: 0.20, ier: 0.20, ieo: 0.50, crime: 0.10 };
            
            const tier2Score = (irsdScore * locationWeights.irsd + 
                               ierScore * locationWeights.ier + 
                               ieoScore * locationWeights.ieo + 
                               crimeScore * locationWeights.crime) * weights.tier2;
            
            // Tier 3: Accessibility
            const cbdScore = normalizeScore(suburb.cbdDistance, 0, 50, true); // Inverse
            const transitScore = suburb.transitScore;
            const walkScore = suburb.walkScore;
            const tier3Score = (cbdScore * 0.30 + transitScore * 0.45 + walkScore * 0.25) / 100 * weights.tier3 * 100;
            
            // Tier 4: Lifestyle
            const schoolScore = suburb.schoolRating;
            const parksScore = normalizeScore(suburb.parksDensity, 0, 10);
            const childcareScore = normalizeScore(suburb.childcareCenters, 0, 20);
            const shoppingScore = normalizeScore(suburb.shoppingCenters, 0, 10);
            const cafesScore = normalizeScore(suburb.cafesRestaurants, 0, 100);
            
            const tier4Score = (schoolScore * 0.40 + parksScore * 0.25 + 
                               childcareScore * 0.20 + shoppingScore * 0.08 + 
                               cafesScore * 0.07) / 100 * weights.tier4 * 100;
            
            const totalScore = tier1Score + tier2Score + tier3Score + tier4Score;
            
            // Update display
            document.getElementById('a-score-value').textContent = totalScore.toFixed(1);
            
            // Create breakdown with simplified tier values and blurred detailed metrics
            const breakdown = document.getElementById('a-score-breakdown');
            breakdown.style.display = 'block';
            breakdown.innerHTML = `
                <div class="breakdown-section">
                    <h4 class="breakdown-title">📊 Tier Values</h4>
                    <div class="breakdown-grid">
                        <div class="breakdown-item">
                            <span class="breakdown-label">💰 Investment</span>
                            <span class="breakdown-value">${tier1Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">📍 Location</span>
                            <span class="breakdown-value">${tier2Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🚊 Accessibility</span>
                            <span class="breakdown-value">${tier3Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏖️ Lifestyle</span>
                            <span class="breakdown-value">${tier4Score.toFixed(0)}</span>
                        </div>
                    </div>
                </div>
                
                <div class="breakdown-section blurred-metrics" style="margin-top: var(--space-xl); padding: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-md); position: relative;">
                    <h4 class="breakdown-title" style="margin-bottom: var(--space-md);">Detailed Metrics (38 data points analyzed)</h4>
                    <div class="breakdown-grid" style="font-size: 0.875rem;">
                        <div class="breakdown-item">
                            <span class="breakdown-label">💰 Investment Tier (${(weights.tier1 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>📈 Capital Growth (1yr): ${growthScore.toFixed(1)} (50-60% of tier)</div>
                                <div>💰 Rental Yield: ${yieldScore.toFixed(1)} (40-50% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">📍 Location Tier (${(weights.tier2 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🛡️ IRSD (Safety): ${irsdScore.toFixed(1)} (${(locationWeights.irsd * 100).toFixed(0)}% of tier)</div>
                                <div>💵 IER (Economic): ${ierScore.toFixed(1)} (${(locationWeights.ier * 100).toFixed(0)}% of tier)</div>
                                <div>🎓 IEO (Education): ${ieoScore.toFixed(1)} (${(locationWeights.ieo * 100).toFixed(0)}% of tier)</div>
                                <div>🚔 Crime Rate: ${crimeScore.toFixed(1)} (${(locationWeights.crime * 100).toFixed(0)}% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🚊 Accessibility Tier (${(weights.tier3 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>📍 CBD Distance: ${cbdScore.toFixed(1)} (30% of tier)</div>
                                <div>🚊 Transit Score: ${transitScore} (45% of tier)</div>
                                <div>🚶 Walk Score: ${walkScore} (25% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏖️ Lifestyle Tier (${(weights.tier4 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🏫 School Rating: ${schoolScore} (40% of tier)</div>
                                <div>🌳 Parks Density: ${parksScore.toFixed(1)} (25% of tier)</div>
                                <div>👶 Childcare: ${childcareScore.toFixed(1)} (20% of tier)</div>
                                <div>🛒 Shopping: ${shoppingScore.toFixed(1)} (8% of tier)</div>
                                <div>☕ Cafes/Restaurants: ${cafesScore.toFixed(1)} (7% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Additional Metrics</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>1yr Growth: ${suburb.growth1yr}% | SEIFA: ${suburb.irsd_decile}/${suburb.ier_decile}/${suburb.ieo_decile}</div>
                                <div>Crime: ${(crimeRate/100).toFixed(0)}/1k | Schools: ${suburb.schoolCount} | Transit: ${suburb.transitScore}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Calculate B-Score
        function calculateBScore() {
            const suburb = document.getElementById('property-suburb-input').value.trim();
            const price = parseFloat(document.getElementById('property-price').value) || 850000;
            const propertyType = document.getElementById('property-type').value;
            const bedrooms = parseInt(document.getElementById('bedrooms').value) || 3;
            const bathrooms = parseFloat(document.getElementById('bathrooms').value) || 2;
            const landSize = parseInt(document.getElementById('land-size').value) || 650;
            const streetQuality = parseInt(document.getElementById('street-quality').value);
            
            if (!suburb) {
                alert('Please select a suburb');
                return;
            }
            
            const suburbData = getSuburbByName(suburb);
            const strategy = getStrategyFromPropertyPrice(price);
            const weights = strategyWeights[strategy].bTiers;
            
            // Calculate tier scores (simplified for demo)
            const affordabilityScore = normalizeScore(1000000 / price, 0.5, 2) * 0.40;
            const propertyTypeScore = propertyType === 'house' ? 100 : 
                                    propertyType === 'townhouse' ? 70 : 
                                    propertyType === 'unit' ? 50 : 35;
            const tier1Score = (affordabilityScore + propertyTypeScore * 0.35) * weights.tier1;
            
            const tier2Score = 75 * weights.tier2; // Simplified
            const tier3Score = 70 * weights.tier3; // Simplified
            const tier4Score = ((landSize / 10) * 0.35 + bedrooms * 10 * 0.25 + 
                               bathrooms * 12 * 0.25 + streetQuality * 15 * 0.15) * weights.tier4;
            const tier5Score = 65 * weights.tier5; // Simplified
            
            const totalScore = Math.min(100, tier1Score + tier2Score + tier3Score + tier4Score + tier5Score);
            
            document.getElementById('b-score-value').textContent = totalScore.toFixed(1);
            
            // Create breakdown with simplified tier values and blurred detailed metrics
            const breakdown = document.getElementById('b-score-breakdown');
            breakdown.style.display = 'block';
            breakdown.innerHTML = `
                <div class="breakdown-section">
                    <h4 class="breakdown-title">📊 Tier Values</h4>
                    <div class="breakdown-grid">
                        <div class="breakdown-item">
                            <span class="breakdown-label">💰 Investment</span>
                            <span class="breakdown-value">${tier1Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">📍 Location</span>
                            <span class="breakdown-value">${tier2Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🚊 Accessibility</span>
                            <span class="breakdown-value">${tier3Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏠 Property Features</span>
                            <span class="breakdown-value">${tier4Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏖️ Lifestyle</span>
                            <span class="breakdown-value">${tier5Score.toFixed(0)}</span>
                        </div>
                    </div>
                </div>
                
                <div class="breakdown-section ${isTestingMode() ? '' : 'blurred-metrics'}" style="margin-top: var(--space-xl); padding: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-md); position: relative;">
                    <h4 class="breakdown-title" style="margin-bottom: var(--space-md);">Detailed Metrics (23 data points analyzed)${isTestingMode() ? ' - Testing Mode' : ''}</h4>
                    <div class="breakdown-grid" style="font-size: 0.875rem;">
                        <div class="breakdown-item">
                            <span class="breakdown-label">💰 Investment Tier (${(weights.tier1 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>💵 Price Affordability: ${affordabilityScore.toFixed(1)} (35-40% of tier)</div>
                                <div>🏠 Property Type: ${propertyTypeScore} (25-35% of tier)</div>
                                <div>📈 Capital Growth: Calculated from suburb (15-25% of tier)</div>
                                <div>💰 Rental Yield: Calculated from suburb (10-15% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">📍 Location Tier (${(weights.tier2 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🛡️ IRSD Score: From suburb (20-35% of tier)</div>
                                <div>💵 IER Score: From suburb (20-25% of tier)</div>
                                <div>🎓 IEO Score: From suburb (20-45% of tier)</div>
                                <div>🚔 Crime Rate: From suburb (10-20% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🚊 Accessibility Tier (${(weights.tier3 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🚗 Primary Commute: From suburb (30-40% of tier)</div>
                                <div>🚗 Secondary Commute: From suburb (25-30% of tier)</div>
                                <div>📍 CBD Distance: From suburb (10-15% of tier)</div>
                                <div>🚊 Transit Score: From suburb (12-20% of tier)</div>
                                <div>🚶 Walk Score: From suburb (8-10% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏠 Property Features Tier (${(weights.tier4 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>📐 Land Size: ${landSize} sqm (30-40% of tier)</div>
                                <div>🛏️ Bedrooms: ${bedrooms} (25% of tier)</div>
                                <div>🚿 Bathrooms: ${bathrooms} (20-25% of tier)</div>
                                <div>🛣️ Street Quality: ${streetQuality}/5 (15-20% of tier)</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏖️ Lifestyle Tier (${(weights.tier5 * 100).toFixed(0)}% weight)</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🏫 School Proximity: From suburb (35-40% of tier)</div>
                                <div>🌳 Parks Access: From suburb (25% of tier)</div>
                                <div>👶 Childcare: From suburb (20% of tier)</div>
                                <div>🛒 Shopping: From suburb (8-10% of tier)</div>
                                <div>☕ Dining: From suburb (7-10% of tier)</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Get suburb data by name
        function getSuburbByName(name) {
            return suburbData.find(s => s.name === name) || suburbData[0];
        }
        
        // Switch tabs
        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tab === 'suburb') {
                document.querySelector('.tab-button:nth-child(1)').classList.add('active');
                document.getElementById('suburb-tab').classList.add('active');
            } else {
                document.querySelector('.tab-button:nth-child(2)').classList.add('active');
                document.getElementById('property-tab').classList.add('active');
            }
        }
        
        // Populate suburb selects
        function populateSuburbs() {
            const suburbSelect = document.getElementById('suburb-select');
            
            // Only populate the A-Score suburb select (still using dropdown)
            if (suburbSelect) {
                suburbData.forEach(suburb => {
                    const option = new Option(suburb.name, suburb.name);
                    suburbSelect.add(option);
                });
            }
            // Property suburb and current suburb now use autocomplete inputs
        }
        
        // Autocomplete functionality for suburb/address inputs
        function setupAutocomplete(inputId, dropdownId, isAddress = false) {
            const input = document.getElementById(inputId);
            const dropdown = document.getElementById(dropdownId);
            if (!input || !dropdown) return;
            
            let selectedIndex = -1;
            let filteredSuburbs = [];
            
            input.addEventListener('input', function() {
                const query = this.value.trim().toLowerCase();
                
                if (query.length < 2) {
                    dropdown.classList.remove('show');
                    return;
                }
                
                // Filter suburbs based on query
                filteredSuburbs = suburbData.filter(suburb => {
                    const suburbName = suburb.name.toLowerCase();
                    const postcode = String(suburb.postcode || '').toLowerCase();
                    
                    if (isAddress) {
                        // For address input, match suburb name or postcode
                        return suburbName.includes(query) || postcode.includes(query);
                    } else {
                        // For suburb input, match suburb name
                        return suburbName.includes(query);
                    }
                }).slice(0, 10); // Limit to 10 results
                
                if (filteredSuburbs.length === 0) {
                    dropdown.classList.remove('show');
                    return;
                }
                
                // Populate dropdown
                dropdown.innerHTML = filteredSuburbs.map((suburb, index) => `
                    <div class="autocomplete-item" data-index="${index}" data-suburb="${suburb.name}" data-postcode="${suburb.postcode}">
                        <span class="autocomplete-item-name">${suburb.name}</span>
                        <span class="autocomplete-item-postcode">${suburb.postcode}</span>
                    </div>
                `).join('');
                
                dropdown.classList.add('show');
                selectedIndex = -1;
                
                // Add click handlers
                dropdown.querySelectorAll('.autocomplete-item').forEach((item, index) => {
                    item.addEventListener('click', function() {
                        const suburbName = this.dataset.suburb;
                        const postcode = this.dataset.postcode;
                        
                        if (isAddress) {
                            // For address, append suburb to address if not already there
                            const currentAddress = input.value.trim();
                            if (!currentAddress.toLowerCase().includes(suburbName.toLowerCase())) {
                                input.value = currentAddress ? `${currentAddress}, ${suburbName}` : suburbName;
                            } else {
                                input.value = currentAddress;
                            }
                        } else {
                            // For suburb input, just set the suburb name
                            input.value = suburbName;
                            
                            // Auto-fill postcode if it's the current house form
                            if (inputId === 'current-suburb-input') {
                                const postcodeInput = document.getElementById('current-postcode');
                                if (postcodeInput) {
                                    postcodeInput.value = postcode || '';
                                }
                            }
                        }
                        
                        dropdown.classList.remove('show');
                    });
                    
                    item.addEventListener('mouseenter', function() {
                        dropdown.querySelectorAll('.autocomplete-item').forEach(i => i.classList.remove('selected'));
                        this.classList.add('selected');
                        selectedIndex = index;
                    });
                });
            });
            
            // Keyboard navigation
            input.addEventListener('keydown', function(e) {
                if (!dropdown.classList.contains('show')) return;
                
                const items = dropdown.querySelectorAll('.autocomplete-item');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    selectedIndex = Math.min(selectedIndex + 1, items.length - 1);
                    items.forEach((item, i) => {
                        item.classList.toggle('selected', i === selectedIndex);
                    });
                    items[selectedIndex]?.scrollIntoView({ block: 'nearest' });
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    selectedIndex = Math.max(selectedIndex - 1, -1);
                    items.forEach((item, i) => {
                        item.classList.toggle('selected', i === selectedIndex);
                    });
                    if (selectedIndex >= 0) {
                        items[selectedIndex]?.scrollIntoView({ block: 'nearest' });
                    }
                } else if (e.key === 'Enter' && selectedIndex >= 0 && items[selectedIndex]) {
                    e.preventDefault();
                    items[selectedIndex].click();
                } else if (e.key === 'Escape') {
                    dropdown.classList.remove('show');
                }
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!input.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.classList.remove('show');
                }
            });
        }
        
        // Calculate distance between two coordinates (Haversine formula)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }
        
        // Find nearest suburb from coordinates
        function findNearestSuburb(lat, lng) {
            let nearest = null;
            let minDistance = Infinity;
            
            suburbData.forEach(suburb => {
                if (suburb.latitude && suburb.longitude) {
                    const distance = calculateDistance(lat, lng, suburb.latitude, suburb.longitude);
                    if (distance < minDistance) {
                        minDistance = distance;
                        nearest = suburb;
                    }
                }
            });
            
            return nearest;
        }
        
        // Get user location via geolocation API
        function getUserLocation() {
            if (!navigator.geolocation) {
                alert('Geolocation is not supported by your browser. Please use the manual address option.');
                document.getElementById('manual-address-form').style.display = 'block';
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const nearestSuburb = findNearestSuburb(lat, lng);
                    
                    if (nearestSuburb) {
                        showTop3Suburbs(nearestSuburb);
                    } else {
                        alert('Could not find a nearby suburb. Please use the manual search.');
                        document.getElementById('manual-address-form').style.display = 'block';
                    }
                },
                function(error) {
                    console.error('Geolocation error:', error);
                    alert('Location access denied. Please use the manual address option.');
                    document.getElementById('manual-address-form').style.display = 'block';
                }
            );
        }
        
        // Find suburb by address (simplified - just searches by suburb name)
        function findSuburbByAddress() {
            const address = document.getElementById('manual-address').value;
            const normalizedAddress = normalizeSearchString(address);
            
            if (!normalizedAddress) {
                alert('Please enter an address');
                return;
            }
            
            // Search for suburb name in address (case-insensitive, handles spaces)
            const foundSuburb = suburbData.find(s => {
                const suburbName = normalizeSearchString(s.name || '');
                // Check if suburb name appears in address
                return normalizedAddress.includes(suburbName);
            });
            
            if (foundSuburb) {
                showTop3Suburbs(foundSuburb);
            } else {
                alert('Could not find suburb in address. Please try searching by suburb name instead.');
            }
        }
        
        // Show top 3 suburbs (user's suburb + 2 nearby)
        function showTop3Suburbs(userSuburb) {
            // Calculate A-Score for user suburb
            const strategy = getStrategyFromPreferences();
            const userAScore = calculateAScoreForSuburb(userSuburb, strategy);
            
            // Filter suburbs by geographic category if preferences exist
            let filteredSuburbs = filterSuburbsByCategory(suburbData);
            
            // Find nearby suburbs and calculate their scores
            const suburbsWithScores = filteredSuburbs.map(suburb => {
                const score = calculateAScoreForSuburb(suburb, strategy);
                const distance = userSuburb.latitude && userSuburb.longitude && suburb.latitude && suburb.longitude
                    ? calculateDistance(userSuburb.latitude, userSuburb.longitude, suburb.latitude, suburb.longitude)
                    : 999;
                return { suburb, score, distance };
            });
            
            // Sort by score and get top 3 (including user's suburb)
            suburbsWithScores.sort((a, b) => b.score - a.score);
            const top3 = [userSuburb, ...suburbsWithScores.filter(s => s.suburb.name !== userSuburb.name).slice(0, 2).map(s => s.suburb)];
            
            // Display results
            const container = document.getElementById('top-suburbs-container');
            container.innerHTML = '';
            
            top3.forEach((suburb, index) => {
                const score = calculateAScoreForSuburb(suburb, strategy);
                const weights = strategyWeights[strategy].aTiers;
                const crimeRate = getCrimeRate(suburb);
                
                // Calculate tier values
                const growthScore = normalizeScore(suburb.growth1yr || 0, -5, 15);
                const yieldScore = normalizeScore(suburb.rentalYield || 0, 1, 6);
                const tier1 = (growthScore * 0.55 + yieldScore * 0.45) * weights.tier1;
                
                const irsdScore = normalizeScore(suburb.irsd_score || 0, 800, 1200);
                const ierScore = normalizeScore(suburb.ier_score || 0, 800, 1200);
                const ieoScore = normalizeScore(suburb.ieo_score || 0, 800, 1200);
                const crimeScore = normalizeScore(crimeRate, 3000, 25000, true);
                const locationWeights = strategy === 'investment' ? 
                    { irsd: 0.45, ier: 0.30, ieo: 0.15, crime: 0.10 } :
                    strategy === 'balanced' ?
                    { irsd: 0.30, ier: 0.25, ieo: 0.30, crime: 0.15 } :
                    { irsd: 0.20, ier: 0.20, ieo: 0.50, crime: 0.10 };
                const tier2 = (irsdScore * locationWeights.irsd + ierScore * locationWeights.ier + ieoScore * locationWeights.ieo + crimeScore * locationWeights.crime) * weights.tier2;
                
                const cbdScore = normalizeScore(suburb.cbdDistance || 0, 0, 50, true);
                const tier3 = ((cbdScore * 0.30 + (suburb.transitScore || 0) * 0.45 + (suburb.walkScore || 0) * 0.25) / 100) * weights.tier3 * 100;
                
                const schoolScore = suburb.schoolRating || 60;
                const parksScore = normalizeScore(suburb.parksDensity || 0, 0, 10);
                const childcareScore = normalizeScore(suburb.childcareCenters || 0, 0, 20);
                const shoppingScore = normalizeScore(suburb.shoppingCenters || 0, 0, 10);
                const cafesScore = normalizeScore(suburb.cafesRestaurants || 0, 0, 100);
                const tier4 = ((schoolScore * 0.40 + parksScore * 0.25 + childcareScore * 0.20 + shoppingScore * 0.08 + cafesScore * 0.07) / 100) * weights.tier4 * 100;
                
                const card = document.createElement('div');
                card.className = 'score-card score-type-suburb';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                        <h3 style="margin: 0;">${suburb.name}</h3>
                        <div style="text-align: right;">
                            <div style="font-size: 2rem; font-weight: 700;" class="text-gradient">${score.toFixed(1)}</div>
                            <div style="color: var(--gray-600); font-size: 0.875rem;">A-Score</div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-sm); margin-bottom: var(--space-md);">
                        <div><strong>Investment:</strong> ${tier1.toFixed(0)}</div>
                        <div><strong>Location:</strong> ${tier2.toFixed(0)}</div>
                        <div><strong>Accessibility:</strong> ${tier3.toFixed(0)}</div>
                        <div><strong>Lifestyle:</strong> ${tier4.toFixed(0)}</div>
                    </div>
                    <div class="${isTestingMode() ? '' : 'blurred-metrics'}" style="padding: var(--space-md); background: var(--gray-50); border-radius: var(--radius-md); font-size: 0.75rem;">
                        <div style="font-weight: 600; margin-bottom: var(--space-xs);">Full A-Score Breakdown (38 data points)${isTestingMode() ? ' - Testing Mode' : ''}</div>
                        <div style="margin-bottom: var(--space-xs);"><strong>Tier 1 - Investment (${(weights.tier1 * 100).toFixed(0)}% weight):</strong></div>
                        <div style="margin-left: var(--space-md); margin-bottom: var(--space-sm);">
                            <div>📈 Capital Growth (1yr): ${suburb.growth1yr || 0}% (55% of tier) | Normalized: ${growthScore.toFixed(1)}</div>
                            <div>💰 Rental Yield: ${suburb.rentalYield || 0}% (45% of tier) | Normalized: ${yieldScore.toFixed(1)}</div>
                            <div><strong>Tier 1 Score: ${tier1.toFixed(1)}</strong></div>
                        </div>
                        <div style="margin-bottom: var(--space-xs);"><strong>Tier 2 - Location (${(weights.tier2 * 100).toFixed(0)}% weight):</strong></div>
                        <div style="margin-left: var(--space-md); margin-bottom: var(--space-sm);">
                            <div>🛡️ IRSD Score: ${suburb.irsd_score || 0} (Decile ${suburb.irsd_decile || 0}) | Normalized: ${irsdScore.toFixed(1)} (${(locationWeights.irsd * 100).toFixed(0)}% of tier)</div>
                            <div>💵 IER Score: ${suburb.ier_score || 0} (Decile ${suburb.ier_decile || 0}) | Normalized: ${ierScore.toFixed(1)} (${(locationWeights.ier * 100).toFixed(0)}% of tier)</div>
                            <div>🎓 IEO Score: ${suburb.ieo_score || 0} (Decile ${suburb.ieo_decile || 0}) | Normalized: ${ieoScore.toFixed(1)} (${(locationWeights.ieo * 100).toFixed(0)}% of tier)</div>
                            <div>🚔 Crime Rate: ${(crimeRate/100).toFixed(0)} per 100k | Normalized: ${crimeScore.toFixed(1)} (${(locationWeights.crime * 100).toFixed(0)}% of tier)</div>
                            <div><strong>Tier 2 Score: ${tier2.toFixed(1)}</strong></div>
                        </div>
                        <div style="margin-bottom: var(--space-xs);"><strong>Tier 3 - Accessibility (${(weights.tier3 * 100).toFixed(0)}% weight):</strong></div>
                        <div style="margin-left: var(--space-md); margin-bottom: var(--space-sm);">
                            <div>📍 CBD Distance: ${suburb.cbdDistance || 0}km | Normalized: ${cbdScore.toFixed(1)} (30% of tier)</div>
                            <div>🚊 Transit Score: ${suburb.transitScore || 0}/100 (45% of tier)</div>
                            <div>🚶 Walk Score: ${suburb.walkScore || 0}/100 (25% of tier)</div>
                            <div><strong>Tier 3 Score: ${tier3.toFixed(1)}</strong></div>
                        </div>
                        <div style="margin-bottom: var(--space-xs);"><strong>Tier 4 - Lifestyle (${(weights.tier4 * 100).toFixed(0)}% weight):</strong></div>
                        <div style="margin-left: var(--space-md); margin-bottom: var(--space-sm);">
                            <div>🏫 School Rating: ${schoolScore}/100 (${suburb.schoolCount || 0} schools) (40% of tier)</div>
                            <div>🌳 Parks Density: ${suburb.parksDensity || 0} | Normalized: ${parksScore.toFixed(1)} (25% of tier)</div>
                            <div>👶 Childcare Centers: ${suburb.childcareCenters || 0} | Normalized: ${childcareScore.toFixed(1)} (20% of tier)</div>
                            <div>🛒 Shopping Centers: ${suburb.shoppingCenters || 0} | Normalized: ${shoppingScore.toFixed(1)} (8% of tier)</div>
                            <div>☕ Cafes/Restaurants: ${suburb.cafesRestaurants || 0} | Normalized: ${cafesScore.toFixed(1)} (7% of tier)</div>
                            <div><strong>Tier 4 Score: ${tier4.toFixed(1)}</strong></div>
                        </div>
                        <div style="margin-top: var(--space-sm); padding-top: var(--space-sm); border-top: 1px solid var(--gray-300);">
                            <div><strong>Strategy:</strong> ${strategy.charAt(0).toUpperCase() + strategy.slice(1)} | <strong>Overall A-Score: ${score.toFixed(1)}</strong></div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
            
            document.getElementById('location-results').style.display = 'block';
        }
        
        // Calculate A-Score for a suburb (helper function)
        function calculateAScoreForSuburb(suburb, strategy) {
            const weights = strategyWeights[strategy].aTiers;
            const crimeRate = getCrimeRate(suburb);
            
            const growthScore = normalizeScore(suburb.growth1yr || 0, -5, 15);
            const yieldScore = normalizeScore(suburb.rentalYield || 0, 1, 6);
            const tier1 = (growthScore * 0.55 + yieldScore * 0.45) * weights.tier1;
            
            const irsdScore = normalizeScore(suburb.irsd_score || 0, 800, 1200);
            const ierScore = normalizeScore(suburb.ier_score || 0, 800, 1200);
            const ieoScore = normalizeScore(suburb.ieo_score || 0, 800, 1200);
            const crimeScore = normalizeScore(crimeRate, 3000, 25000, true);
            const locationWeights = strategy === 'investment' ? 
                { irsd: 0.45, ier: 0.30, ieo: 0.15, crime: 0.10 } :
                strategy === 'balanced' ?
                { irsd: 0.30, ier: 0.25, ieo: 0.30, crime: 0.15 } :
                { irsd: 0.20, ier: 0.20, ieo: 0.50, crime: 0.10 };
            const tier2 = (irsdScore * locationWeights.irsd + ierScore * locationWeights.ier + ieoScore * locationWeights.ieo + crimeScore * locationWeights.crime) * weights.tier2;
            
            const cbdScore = normalizeScore(suburb.cbdDistance || 0, 0, 50, true);
            const tier3 = ((cbdScore * 0.30 + (suburb.transitScore || 0) * 0.45 + (suburb.walkScore || 0) * 0.25) / 100) * weights.tier3 * 100;
            
            const schoolScore = suburb.schoolRating || 60;
            const parksScore = normalizeScore(suburb.parksDensity || 0, 0, 10);
            const childcareScore = normalizeScore(suburb.childcareCenters || 0, 0, 20);
            const shoppingScore = normalizeScore(suburb.shoppingCenters || 0, 0, 10);
            const cafesScore = normalizeScore(suburb.cafesRestaurants || 0, 0, 100);
            const tier4 = ((schoolScore * 0.40 + parksScore * 0.25 + childcareScore * 0.20 + shoppingScore * 0.08 + cafesScore * 0.07) / 100) * weights.tier4 * 100;
            
            return tier1 + tier2 + tier3 + tier4;
        }
        
        // Normalize search string (trim, lowercase, normalize spaces)
        function normalizeSearchString(str) {
            return str.trim().toLowerCase().replace(/\s+/g, ' ');
        }
        
        // Search suburb with limitation
        function searchSuburb() {
            // Check if suburb data is loaded
            if (!suburbData || suburbData.length === 0) {
                alert('Suburb data is still loading. Please wait a moment and try again.');
                console.error('suburbData is empty:', suburbData);
                return;
            }
            
            // Check if user has paid access or testing mode
            const hasPaidAccess = isTestingMode();
            
            const searchInput = document.getElementById('suburb-search-input').value;
            const normalizedInput = normalizeSearchString(searchInput);
            
            if (!normalizedInput) {
                alert('Please enter a suburb name');
                return;
            }
            
            if (!hasPaidAccess) {
                const searchCount = parseInt(sessionStorage.getItem('searchCount') || '0');
                
                if (searchCount >= 3) {
                    const limitMsg = document.getElementById('search-limit-message');
                    const searchBtn = document.getElementById('search-btn');
                    if (limitMsg) limitMsg.style.display = 'block';
                    if (searchBtn) searchBtn.disabled = true;
                    return;
                }
            }
            
            // Filter suburbs by geographic category if preferences exist
            let filteredSuburbs = filterSuburbsByCategory(suburbData);
            
            // Debug logging
            console.log('Search input:', normalizedInput);
            console.log('Total suburbs:', suburbData.length);
            console.log('Filtered suburbs:', filteredSuburbs.length);
            
            // Search with flexible matching (case-insensitive, handles spaces)
            const foundSuburb = filteredSuburbs.find(s => {
                const suburbName = normalizeSearchString(s.name || '');
                // Try exact match first
                if (suburbName === normalizedInput) return true;
                // Try contains match
                if (suburbName.includes(normalizedInput)) return true;
                // Try reverse (search term contains suburb name - for partial matches)
                if (normalizedInput.includes(suburbName)) return true;
                return false;
            });
            
            if (foundSuburb) {
                if (!hasPaidAccess) {
                    const currentCount = parseInt(sessionStorage.getItem('searchCount') || '0');
                    sessionStorage.setItem('searchCount', (currentCount + 1).toString());
                }
                showTop3Suburbs(foundSuburb);
            } else {
                // Provide more helpful error message
                const suggestions = filteredSuburbs
                    .filter(s => {
                        const name = normalizeSearchString(s.name || '');
                        return name.startsWith(normalizedInput.substring(0, 3));
                    })
                    .slice(0, 5)
                    .map(s => s.name);
                
                let errorMsg = 'Suburb not found. Please check the spelling.';
                if (suggestions.length > 0) {
                    errorMsg += '\n\nDid you mean:\n' + suggestions.join('\n');
                }
                alert(errorMsg);
                console.log('Search failed. Filtered suburbs sample:', filteredSuburbs.slice(0, 10).map(s => s.name));
            }
        }
        
        // Evaluate current house
        function evaluateCurrentHouse() {
            const address = document.getElementById('current-address').value;
            const suburbName = document.getElementById('current-suburb-input').value.trim();
            const price = parseFloat(document.getElementById('current-price').value);
            const propertyType = document.getElementById('current-property-type').value;
            const bedrooms = parseInt(document.getElementById('current-bedrooms').value) || 3;
            const bathrooms = parseFloat(document.getElementById('current-bathrooms').value) || 2;
            const landSize = parseInt(document.getElementById('current-land-size').value) || 650;
            const streetQuality = parseInt(document.getElementById('current-street-quality').value);
            
            if (!suburbName) {
                alert('Please select a suburb');
                return;
            }
            
            if (!price || price <= 0) {
                alert('Please enter a valid estimated value');
                return;
            }
            
            const suburb = getSuburbByName(suburbName);
            const strategy = getStrategyFromPropertyPrice(price);
            const weights = strategyWeights[strategy].bTiers;
            
            // Calculate B-Score
            const affordabilityScore = normalizeScore(1000000 / price, 0.5, 2) * 0.40;
            const propertyTypeScore = propertyType === 'house' ? 100 : 
                                    propertyType === 'townhouse' ? 70 : 
                                    propertyType === 'unit' ? 50 : 35;
            const tier1Score = (affordabilityScore + propertyTypeScore * 0.35) * weights.tier1;
            
            const tier2Score = 75 * weights.tier2; // Simplified - uses suburb location data
            const tier3Score = 70 * weights.tier3; // Simplified - uses suburb accessibility data
            const tier4Score = ((landSize / 10) * 0.35 + bedrooms * 10 * 0.25 + 
                               bathrooms * 12 * 0.25 + streetQuality * 15 * 0.15) * weights.tier4;
            const tier5Score = 65 * weights.tier5; // Simplified - uses suburb lifestyle data
            
            const totalScore = Math.min(100, tier1Score + tier2Score + tier3Score + tier4Score + tier5Score);
            
            // Display results
            document.getElementById('current-b-score-value').textContent = totalScore.toFixed(1);
            document.getElementById('current-house-score-display').style.display = 'block';
            
            const breakdown = document.getElementById('current-house-breakdown');
            breakdown.style.display = 'block';
            breakdown.innerHTML = `
                <div class="breakdown-section">
                    <h4 class="breakdown-title">📊 Tier Values</h4>
                    <div class="breakdown-grid">
                        <div class="breakdown-item">
                            <span class="breakdown-label">💰 Investment</span>
                            <span class="breakdown-value">${tier1Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">📍 Location</span>
                            <span class="breakdown-value">${tier2Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🚊 Accessibility</span>
                            <span class="breakdown-value">${tier3Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏠 Property Features</span>
                            <span class="breakdown-value">${tier4Score.toFixed(0)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏖️ Lifestyle</span>
                            <span class="breakdown-value">${tier5Score.toFixed(0)}</span>
                        </div>
                    </div>
                </div>
                
                <div class="breakdown-section ${isTestingMode() ? '' : 'blurred-metrics'}" style="margin-top: var(--space-xl); padding: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-md); position: relative;">
                    <h4 class="breakdown-title" style="margin-bottom: var(--space-md);">Detailed Metrics (23 data points analyzed)${isTestingMode() ? ' - Testing Mode' : ''}</h4>
                    <div class="breakdown-grid" style="font-size: 0.875rem;">
                        <div class="breakdown-item">
                            <span class="breakdown-label">💰 Investment Tier</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>💵 Price Affordability: ${affordabilityScore.toFixed(1)}</div>
                                <div>🏠 Property Type: ${propertyTypeScore}</div>
                                <div>📈 Capital Growth: From ${suburb.name}</div>
                                <div>💰 Rental Yield: From ${suburb.name}</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">📍 Location Tier</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🛡️ IRSD: ${suburb.irsd_decile || 0} | 💵 IER: ${suburb.ier_decile || 0}</div>
                                <div>🎓 IEO: ${suburb.ieo_decile || 0} | 🚔 Crime: From ${suburb.lga || 'area'}</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🚊 Accessibility Tier</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🚗 Commute: From ${suburb.name} | 📍 CBD: ${suburb.cbdDistance || 0}km</div>
                                <div>🚊 Transit: ${suburb.transitScore || 0} | 🚶 Walk: ${suburb.walkScore || 0}</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏠 Property Features Tier</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>📐 Land: ${landSize} sqm | 🛏️ Beds: ${bedrooms} | 🚿 Baths: ${bathrooms}</div>
                                <div>🛣️ Street Quality: ${streetQuality}/5</div>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">🏖️ Lifestyle Tier</span>
                            <div style="margin-left: var(--space-md); margin-top: var(--space-xs);">
                                <div>🏫 Schools: ${suburb.schoolCount || 0} | 🌳 Parks: ${suburb.parksDensity || 0}</div>
                                <div>👶 Childcare: ${suburb.childcareCenters || 0} | 🛒 Shopping: ${suburb.shoppingCenters || 0}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Show save prompt
            document.getElementById('save-property-prompt').style.display = 'block';
            
            // Store current property data for saving
            window.currentPropertyData = {
                address,
                suburb: suburbName,
                postcode: suburb.postcode,
                price,
                propertyType,
                bedrooms,
                bathrooms,
                landSize,
                streetQuality,
                bScore: totalScore,
                timestamp: new Date().toISOString()
            };
        }
        
        // Save current property to localStorage
        function saveCurrentProperty() {
            if (!window.currentPropertyData) return;
            
            const saved = loadPropertiesFromStorage();
            
            // If editing, update existing property
            if (window.editingPropertyId) {
                const index = saved.findIndex(p => p.id === window.editingPropertyId);
                if (index !== -1) {
                    saved[index] = {
                        ...window.currentPropertyData,
                        id: window.editingPropertyId,
                        timestamp: saved[index].timestamp // Keep original timestamp
                    };
                    window.editingPropertyId = null;
                }
            } else {
                // Add new property
                const newProperty = {
                    ...window.currentPropertyData,
                    id: Date.now().toString()
                };
                saved.push(newProperty);
            }
            
            try {
                localStorage.setItem('homescorepro_properties', JSON.stringify(saved));
                document.getElementById('save-property-prompt').style.display = 'none';
                alert(window.editingPropertyId ? 'Property updated successfully!' : 'Property saved successfully!');
                displaySavedProperties();
                updateMyPropertiesNav();
            } catch (error) {
                console.error('Error saving property:', error);
                alert('Error saving property. Please check your browser settings.');
            }
        }
        
        // Load properties from localStorage
        function loadPropertiesFromStorage() {
            try {
                const stored = localStorage.getItem('homescorepro_properties');
                return stored ? JSON.parse(stored) : [];
            } catch (error) {
                console.error('Error loading properties:', error);
                return [];
            }
        }
        
        // Display sample properties
        function displaySampleProperties() {
            const container = document.getElementById('sample-properties-container');
            if (!container || !propertiesData || propertiesData.length === 0) {
                return;
            }
            
            // Get first 8 properties
            const sampleProperties = propertiesData.slice(0, 8);
            
            container.innerHTML = '';
            
            sampleProperties.forEach(prop => {
                // Get suburb data for this property
                const suburb = getSuburbByName(prop.suburb);
                if (!suburb) return;
                
                // Calculate B-Score
                const price = parseFloat(prop.price) || 0;
                const strategy = getStrategyFromPropertyPrice(price);
                const weights = strategyWeights[strategy].bTiers;
                
                // Simplified B-Score calculation (using same logic as calculateBScore)
                const affordabilityScore = normalizeScore(1000000 / price, 0.5, 2) * 0.40;
                const propertyTypeScore = prop.propertyType === 'house' ? 100 : 
                                        prop.propertyType === 'townhouse' ? 70 : 
                                        prop.propertyType === 'unit' ? 50 : 35;
                const tier1Score = (affordabilityScore + propertyTypeScore * 0.35) * weights.tier1;
                
                // Simplified tier scores for display
                const tier2Score = 75 * weights.tier2;
                const tier3Score = 70 * weights.tier3;
                const landSize = parseInt(prop.landSize) || 0;
                const bedrooms = parseInt(prop.bedrooms) || 0;
                const bathrooms = parseFloat(prop.bathrooms) || 0;
                const streetQuality = parseInt(prop.streetQuality) || 3;
                const tier4Score = ((landSize / 10) * 0.35 + bedrooms * 10 * 0.25 + 
                                   bathrooms * 12 * 0.25 + streetQuality * 15 * 0.15) * weights.tier4;
                const tier5Score = 65 * weights.tier5;
                
                const totalScore = Math.min(100, tier1Score + tier2Score + tier3Score + tier4Score + tier5Score);
                
                const card = document.createElement('div');
                card.className = 'sample-property-card';
                card.innerHTML = `
                    <div class="sample-property-header">
                        <div>
                            <div class="sample-property-address">${prop.address || 'Address not available'}</div>
                            <div class="sample-property-location">${prop.suburb}, ${prop.postcode}</div>
                        </div>
                        <div class="sample-property-score">
                            <div class="sample-property-score-value">${totalScore.toFixed(1)}</div>
                            <div class="sample-property-score-label">B-Score</div>
                        </div>
                    </div>
                    <div class="sample-property-details">
                        <div class="sample-property-detail">
                            <span class="sample-property-detail-label">Price: </span>
                            <span class="sample-property-detail-value">$${parseFloat(prop.price || 0).toLocaleString()}</span>
                        </div>
                        <div class="sample-property-detail">
                            <span class="sample-property-detail-label">Type: </span>
                            <span class="sample-property-detail-value">${prop.propertyType || 'N/A'}</span>
                        </div>
                        <div class="sample-property-detail">
                            <span class="sample-property-detail-label">Bedrooms: </span>
                            <span class="sample-property-detail-value">${prop.bedrooms || 'N/A'}</span>
                        </div>
                        <div class="sample-property-detail">
                            <span class="sample-property-detail-label">Bathrooms: </span>
                            <span class="sample-property-detail-value">${prop.bathrooms || 'N/A'}</span>
                        </div>
                    </div>
                    <div class="sample-property-tiers">
                        <div class="sample-property-tier">
                            <span class="sample-property-tier-label">💰 Investment</span>
                            <span class="sample-property-tier-value">${tier1Score.toFixed(0)}</span>
                        </div>
                        <div class="sample-property-tier">
                            <span class="sample-property-tier-label">📍 Location</span>
                            <span class="sample-property-tier-value">${tier2Score.toFixed(0)}</span>
                        </div>
                        <div class="sample-property-tier">
                            <span class="sample-property-tier-label">🚊 Accessibility</span>
                            <span class="sample-property-tier-value">${tier3Score.toFixed(0)}</span>
                        </div>
                        <div class="sample-property-tier">
                            <span class="sample-property-tier-label">🏖️ Lifestyle</span>
                            <span class="sample-property-tier-value">${tier5Score.toFixed(0)}</span>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // Display saved properties
        function displaySavedProperties() {
            const saved = loadPropertiesFromStorage();
            const container = document.getElementById('saved-properties-container');
            const listDiv = document.getElementById('saved-properties-list');
            
            if (saved.length === 0) {
                listDiv.style.display = 'none';
                return;
            }
            
            listDiv.style.display = 'block';
            container.innerHTML = '';
            
            saved.forEach(prop => {
                const propDiv = document.createElement('div');
                propDiv.style.cssText = 'padding: var(--space-md); background: var(--white); border-radius: var(--radius-md); margin-bottom: var(--space-sm); border: 1px solid var(--gray-200);';
                propDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div style="flex: 1;">
                            <strong>${prop.address || 'Address not provided'}</strong><br>
                            <span style="color: var(--gray-600); font-size: 0.875rem;">${prop.suburb} ${prop.postcode}</span><br>
                            <span style="color: var(--gray-500); font-size: 0.75rem;">B-Score: ${prop.bScore.toFixed(1)} | Price: $${(prop.price || 0).toLocaleString()} | Saved: ${new Date(prop.timestamp).toLocaleDateString()}</span>
                        </div>
                        <div style="display: flex; gap: var(--space-xs);">
                            <button onclick="editProperty('${prop.id}')" style="background: var(--info); color: white; border: none; padding: var(--space-xs) var(--space-sm); border-radius: var(--radius-sm); cursor: pointer; font-size: 0.875rem;" title="Edit property">Edit</button>
                            <button onclick="exportProperty('${prop.id}')" style="background: var(--accent); color: white; border: none; padding: var(--space-xs) var(--space-sm); border-radius: var(--radius-sm); cursor: pointer; font-size: 0.875rem;" title="Export as JSON">Export</button>
                            <button onclick="deleteProperty('${prop.id}')" style="background: var(--error); color: white; border: none; padding: var(--space-xs) var(--space-sm); border-radius: var(--radius-sm); cursor: pointer; font-size: 0.875rem;" title="Delete property">Delete</button>
                        </div>
                    </div>
                `;
                container.appendChild(propDiv);
            });
        }
        
        // Edit property
        function editProperty(id) {
            const saved = loadPropertiesFromStorage();
            const property = saved.find(p => p.id === id);
            if (!property) return;
            
            // Populate form with property data
            document.getElementById('current-address').value = property.address || '';
            document.getElementById('current-suburb-input').value = property.suburb || '';
            document.getElementById('current-price').value = property.price || '';
            document.getElementById('current-property-type').value = property.propertyType || 'house';
            document.getElementById('current-bedrooms').value = property.bedrooms || 3;
            document.getElementById('current-bathrooms').value = property.bathrooms || 2;
            document.getElementById('current-land-size').value = property.landSize || 650;
            document.getElementById('current-street-quality').value = property.streetQuality || 3;
            
            // Scroll to form
            document.getElementById('calculator').scrollIntoView({ behavior: 'smooth' });
            
            // Show edit mode indicator
            window.editingPropertyId = id;
            alert('Property loaded for editing. Update the form and click "Evaluate My Home" to save changes.');
        }
        
        // Export single property as JSON
        function exportProperty(id) {
            const saved = loadPropertiesFromStorage();
            const property = saved.find(p => p.id === id);
            if (!property) return;
            
            const json = JSON.stringify(property, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `property-${property.address.replace(/[^a-z0-9]/gi, '-').toLowerCase()}-${id}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Export all properties as JSON
        function exportAllProperties() {
            const saved = loadPropertiesFromStorage();
            if (saved.length === 0) {
                alert('No properties to export');
                return;
            }
            
            const json = JSON.stringify(saved, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `homescorepro-properties-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Bulk import sample properties (for testing)
        function bulkImportProperties() {
            if (!isTestingMode()) {
                alert('Bulk import is only available in testing mode. Enter password to enable.');
                return;
            }
            
            if (!confirm('Import sample properties from properties.csv? This will add them to your saved properties.')) return;
            
            if (!propertiesData || propertiesData.length === 0) {
                alert('No properties data available');
                return;
            }
            
            const saved = loadPropertiesFromStorage();
            let imported = 0;
            
            // Import first 8 properties as samples
            propertiesData.slice(0, 8).forEach(prop => {
                // Check if already exists
                const exists = saved.some(p => p.address === prop.address && p.suburb === prop.suburb);
                if (exists) return;
                
                // Calculate B-Score
                const price = parseFloat(prop.price) || 0;
                const strategy = getStrategyFromPropertyPrice(price);
                const weights = strategyWeights[strategy].bTiers;
                const suburb = getSuburbByName(prop.suburb);
                
                if (!suburb) return;
                
                // Simplified B-Score calculation
                const affordabilityScore = normalizeScore(1000000 / price, 0.5, 2) * 0.40;
                const propertyTypeScore = prop.propertyType === 'house' ? 100 : 
                                        prop.propertyType === 'townhouse' ? 70 : 
                                        prop.propertyType === 'unit' ? 50 : 35;
                const tier1Score = (affordabilityScore + propertyTypeScore * 0.35) * weights.tier1;
                const tier2Score = 75 * weights.tier2;
                const tier3Score = 70 * weights.tier3;
                const landSize = parseInt(prop.landSize) || 0;
                const bedrooms = parseInt(prop.bedrooms) || 0;
                const bathrooms = parseFloat(prop.bathrooms) || 0;
                const streetQuality = parseInt(prop.streetQuality) || 3;
                const tier4Score = ((landSize / 10) * 0.35 + bedrooms * 10 * 0.25 + 
                                   bathrooms * 12 * 0.25 + streetQuality * 15 * 0.15) * weights.tier4;
                const tier5Score = 65 * weights.tier5;
                const totalScore = Math.min(100, tier1Score + tier2Score + tier3Score + tier4Score + tier5Score);
                
                const newProperty = {
                    id: Date.now().toString() + imported,
                    address: prop.address || '',
                    suburb: prop.suburb || '',
                    postcode: prop.postcode || '',
                    price: price,
                    propertyType: prop.propertyType || 'house',
                    bedrooms: bedrooms,
                    bathrooms: bathrooms,
                    landSize: landSize,
                    streetQuality: streetQuality,
                    bScore: totalScore,
                    timestamp: new Date().toISOString()
                };
                
                saved.push(newProperty);
                imported++;
            });
            
            localStorage.setItem('homescorepro_properties', JSON.stringify(saved));
            displaySavedProperties();
            updateMyPropertiesNav();
            alert(`Imported ${imported} sample properties`);
        }
        
        // Compare properties side-by-side
        function compareProperties() {
            const saved = loadPropertiesFromStorage();
            if (saved.length < 2) {
                alert('Need at least 2 properties to compare');
                return;
            }
            
            const comparisonDiv = document.getElementById('property-comparison-view');
            comparisonDiv.style.display = 'block';
            comparisonDiv.innerHTML = `
                <h4 style="margin-bottom: var(--space-md);">Property Comparison</h4>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; background: var(--white); border-radius: var(--radius-md); overflow: hidden;">
                        <thead>
                            <tr style="background: var(--gray-100);">
                                <th style="padding: var(--space-md); text-align: left; border-bottom: 2px solid var(--gray-200);">Property</th>
                                <th style="padding: var(--space-md); text-align: center; border-bottom: 2px solid var(--gray-200);">B-Score</th>
                                <th style="padding: var(--space-md); text-align: center; border-bottom: 2px solid var(--gray-200);">Price</th>
                                <th style="padding: var(--space-md); text-align: center; border-bottom: 2px solid var(--gray-200);">Type</th>
                                <th style="padding: var(--space-md); text-align: center; border-bottom: 2px solid var(--gray-200);">Bedrooms</th>
                                <th style="padding: var(--space-md); text-align: center; border-bottom: 2px solid var(--gray-200);">Bathrooms</th>
                                <th style="padding: var(--space-md); text-align: center; border-bottom: 2px solid var(--gray-200);">Suburb</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${saved.map(prop => `
                                <tr style="border-bottom: 1px solid var(--gray-200);">
                                    <td style="padding: var(--space-md);">
                                        <strong>${prop.address || 'N/A'}</strong>
                                    </td>
                                    <td style="padding: var(--space-md); text-align: center; font-weight: 600; color: var(--primary);">
                                        ${prop.bScore.toFixed(1)}
                                    </td>
                                    <td style="padding: var(--space-md); text-align: center;">
                                        $${(prop.price || 0).toLocaleString()}
                                    </td>
                                    <td style="padding: var(--space-md); text-align: center; text-transform: capitalize;">
                                        ${prop.propertyType || 'N/A'}
                                    </td>
                                    <td style="padding: var(--space-md); text-align: center;">
                                        ${prop.bedrooms || 'N/A'}
                                    </td>
                                    <td style="padding: var(--space-md); text-align: center;">
                                        ${prop.bathrooms || 'N/A'}
                                    </td>
                                    <td style="padding: var(--space-md); text-align: center;">
                                        ${prop.suburb || 'N/A'}
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                <button class="btn-secondary" onclick="document.getElementById('property-comparison-view').style.display='none'" style="margin-top: var(--space-md);">Close Comparison</button>
            `;
            
            // Scroll to comparison
            comparisonDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Delete property from localStorage
        function deleteProperty(id) {
            if (!confirm('Delete this property?')) return;
            
            const saved = loadPropertiesFromStorage();
            const filtered = saved.filter(p => p.id !== id);
            localStorage.setItem('homescorepro_properties', JSON.stringify(filtered));
            displaySavedProperties();
            updateMyPropertiesNav();
        }
        
        // Update "My Properties" nav link visibility
        function updateMyPropertiesNav() {
            const saved = loadPropertiesFromStorage();
            const navLink = document.getElementById('nav-my-properties');
            if (navLink) {
                navLink.style.display = saved.length > 0 ? 'block' : 'none';
            }
        }
        
        // Auto-fill postcode when suburb is selected (now handled in autocomplete)
        function setupSuburbPostcodeAutoFill() {
            // Postcode auto-fill is now handled in the autocomplete setup
            // This function is kept for compatibility but autocomplete handles it
        }
        
        // Populate data table - Top 15 suburbs by A-Score
        function populateDataTable() {
            const tbody = document.getElementById('suburb-tbody');
            tbody.innerHTML = ''; // Clear existing rows
            
            // Get strategy from preferences or use default
            const strategy = getStrategyFromPreferences();
            
            // Calculate A-Score for all suburbs and create array with scores
            const suburbsWithScores = suburbData.map(suburb => {
                const aScore = calculateAScoreForSuburb(suburb, strategy);
                return { suburb, aScore };
            });
            
            // Sort by A-Score descending and take top 15
            const top15 = suburbsWithScores
                .sort((a, b) => b.aScore - a.aScore)
                .slice(0, 15);
            
            // Populate table with top 15
            top15.forEach(({ suburb, aScore }) => {
                const crimeRate = getCrimeRate(suburb);
                const row = tbody.insertRow();
                
                // Apply blur class to all value cells (not suburb name)
                row.innerHTML = `
                    <td><strong>${suburb.name}</strong></td>
                    <td class="blurred-metrics"><strong>${aScore.toFixed(1)}</strong></td>
                    <td class="blurred-metrics">$${(suburb.medianPrice / 1000000).toFixed(2)}M</td>
                    <td class="blurred-metrics">${(suburb.growth1yr || 0).toFixed(2)}%</td>
                    <td class="blurred-metrics">${(suburb.rentalYield || 0).toFixed(2)}%</td>
                    <td class="blurred-metrics">${(suburb.irsd_score || 0).toFixed(0)}</td>
                    <td class="blurred-metrics">${(suburb.ier_score || 0).toFixed(0)}</td>
                    <td class="blurred-metrics">${(suburb.ieo_score || 0).toFixed(0)}</td>
                    <td class="blurred-metrics">${(crimeRate / 100).toFixed(0)}/1k</td>
                    <td class="blurred-metrics">${(suburb.cbdDistance || 0).toFixed(1)}km</td>
                    <td class="blurred-metrics">${(suburb.transitScore || 0).toFixed(0)}</td>
                    <td class="blurred-metrics">${(suburb.walkScore || 0).toFixed(0)}</td>
                    <td class="blurred-metrics">${(suburb.schoolRating || 60).toFixed(0)}</td>
                    <td class="blurred-metrics">${(suburb.parksDensity || 0).toFixed(2)}</td>
                    <td class="blurred-metrics">${(suburb.childcareCenters || 0)}</td>
                    <td class="blurred-metrics">${(suburb.shoppingCenters || 0)}</td>
                    <td class="blurred-metrics">${(suburb.cafesRestaurants || 0)}</td>
                `;
            });
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', async function() {
            // Show loading indicator
            const loadingMsg = document.createElement('div');
            loadingMsg.id = 'loading-message';
            loadingMsg.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000;';
            loadingMsg.innerHTML = '<div class="loading"></div> <p style="margin-top: 10px;">Loading data...</p>';
            document.body.appendChild(loadingMsg);
            
            try {
                // Load all data files
                const [suburbsLoaded, propertiesLoaded, configLoaded] = await Promise.all([
                    loadSuburbsData(),
                    loadPropertiesData(),
                    loadConfigData()
                ]);
                
                // Use sample data as fallback if CSV loading failed
                if (!suburbsLoaded || suburbData.length === 0) {
                    console.warn('Using sample data as fallback');
                    suburbData = sampleSuburbData;
                }
                
                // Remove loading indicator
                loadingMsg.remove();
                
                // Initialize UI with loaded data
                populateSuburbs();
                populateDataTable();
                setupSuburbPostcodeAutoFill();
                
                // Setup autocomplete for property and address inputs
                setupAutocomplete('property-address', 'property-address-autocomplete', true);
                setupAutocomplete('property-suburb-input', 'property-suburb-autocomplete', false);
                setupAutocomplete('current-address', 'current-address-autocomplete', true);
                setupAutocomplete('current-suburb-input', 'current-suburb-autocomplete', false);
                
                displaySavedProperties();
                updateMyPropertiesNav();
                displaySampleProperties();
            } catch (error) {
                console.error('Error during initialization:', error);
                loadingMsg.remove();
                // Use sample data as fallback
                suburbData = sampleSuburbData;
                populateSuburbs();
                populateDataTable();
                setupSuburbPostcodeAutoFill();
                
                // Setup autocomplete for property and address inputs
                setupAutocomplete('property-address', 'property-address-autocomplete', true);
                setupAutocomplete('property-suburb-input', 'property-suburb-autocomplete', false);
                setupAutocomplete('current-address', 'current-address-autocomplete', true);
                setupAutocomplete('current-suburb-input', 'current-suburb-autocomplete', false);
                
                displaySavedProperties();
                updateMyPropertiesNav();
            }
            
            // Register Service Worker for PWA support
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/service-worker.js')
                        .then((registration) => {
                            console.log('Service Worker registered successfully:', registration.scope);
                        })
                        .catch((error) => {
                            console.log('Service Worker registration failed:', error);
                        });
                });
            }
            
            // Smooth scroll for navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });
            
            // Check if user already has paid access
            checkPaidAccess();
            
            // Check for paid access and show Members link (onboarding moved to members.html)
            checkOnboarding();
            
            // Apply testing mode if active
            if (isTestingMode()) {
                removeBlurFromMetrics();
            }
        });
        
        // ═══════════════════════════════════════════════════════════════
        // ONBOARDING FUNCTIONS
        // ═══════════════════════════════════════════════════════════════
        
        let currentStep = 1;
        const totalSteps = 6;
        let onboardingData = {
            primaryGoal: null,
            budgetMin: 500000,
            budgetMax: 750000,
            familyStatus: null,
            safetyPriority: 8,
            geographicCategories: []
        };
        
        // Check if onboarding is needed (ONLY for paid users - removed from public index.html)
        // Onboarding is now only available in members.html for paid subscribers
        function checkOnboarding() {
            // On public index.html, onboarding is NOT shown automatically
            // Paid users should access onboarding via members.html
            const preferences = localStorage.getItem('homescorepro_preferences');
            if (preferences) {
                // Load preferences if they exist (from previous paid access)
                try {
                    const prefs = JSON.parse(preferences);
                    if (prefs.onboardingComplete) {
                        onboardingData = prefs;
                        applyPreferences();
                    }
                } catch (e) {
                    console.error('Error loading preferences:', e);
                }
            }
            
            // Show Members link if user has paid access
            if (isTestingMode() || localStorage.getItem('homescorepro_paid_access') === 'true') {
                const membersLink = document.getElementById('nav-members');
                const membersLinkBottom = document.getElementById('nav-members-link');
                if (membersLink) {
                    membersLink.style.display = 'block';
                }
                if (membersLinkBottom) {
                    membersLinkBottom.style.display = 'block';
                }
            }
        }
        
        // Manual trigger for onboarding (for testing/debugging)
        function showOnboardingManually() {
            showOnboarding();
        }
        
        function showOnboarding() {
            const overlay = document.getElementById('onboarding-overlay');
            if (overlay) {
                overlay.classList.add('active');
            }
        }
        
        function hideOnboarding() {
            const overlay = document.getElementById('onboarding-overlay');
            if (overlay) {
                overlay.classList.remove('active');
            }
        }
        
        function selectOption(element, key, value) {
            // Remove selected class from siblings
            const siblings = element.parentElement.querySelectorAll('.onboarding-option');
            siblings.forEach(sib => sib.classList.remove('selected'));
            element.classList.add('selected');
            onboardingData[key] = value;
        }
        
        function toggleCheckbox(element, value) {
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('selected', checkbox.checked);
            
            if (checkbox.checked) {
                if (!onboardingData.geographicCategories.includes(value)) {
                    onboardingData.geographicCategories.push(value);
                }
            } else {
                onboardingData.geographicCategories = onboardingData.geographicCategories.filter(c => c !== value);
            }
        }
        
        function selectAllGeographic() {
            const checkboxes = document.querySelectorAll('#step-5 input[type="checkbox"]');
            checkboxes.forEach(cb => {
                cb.checked = true;
                const parent = cb.closest('.onboarding-checkbox');
                if (parent) {
                    parent.classList.add('selected');
                }
                const value = cb.value;
                if (!onboardingData.geographicCategories.includes(value)) {
                    onboardingData.geographicCategories.push(value);
                }
            });
        }
        
        function nextStep() {
            // Validate current step
            if (currentStep === 1 && !onboardingData.primaryGoal) {
                alert('Please select your primary goal');
                return;
            }
            if (currentStep === 2) {
                const min = parseInt(document.getElementById('budget-min').value);
                const max = parseInt(document.getElementById('budget-max').value);
                if (min >= max) {
                    alert('Maximum budget must be greater than minimum budget');
                    return;
                }
                onboardingData.budgetMin = min;
                onboardingData.budgetMax = max;
            }
            if (currentStep === 3 && !onboardingData.familyStatus) {
                alert('Please select your family status');
                return;
            }
            if (currentStep === 4) {
                onboardingData.safetyPriority = parseInt(document.getElementById('safety-priority').value);
            }
            if (currentStep === 5 && onboardingData.geographicCategories.length === 0) {
                alert('Please select at least one geographic category or click "I want to see all"');
                return;
            }
            
            if (currentStep === 6) {
                // Save and complete
                savePreferences();
                return;
            }
            
            // Move to next step
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            currentStep++;
            document.getElementById(`step-${currentStep}`).classList.add('active');
            updateProgress();
            updateButtons();
            
            if (currentStep === 6) {
                updateReview();
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                document.getElementById(`step-${currentStep}`).classList.remove('active');
                currentStep--;
                document.getElementById(`step-${currentStep}`).classList.add('active');
                updateProgress();
                updateButtons();
            }
        }
        
        function updateProgress() {
            const dots = document.querySelectorAll('.onboarding-progress-dot');
            dots.forEach((dot, index) => {
                if (index < currentStep) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }
        
        function updateButtons() {
            const backBtn = document.getElementById('onboarding-back');
            const nextBtn = document.getElementById('onboarding-next');
            
            if (currentStep === 1) {
                backBtn.style.display = 'none';
            } else {
                backBtn.style.display = 'inline-block';
            }
            
            if (currentStep === totalSteps) {
                nextBtn.textContent = 'Complete';
            } else {
                nextBtn.textContent = 'Next';
            }
        }
        
        function updateReview() {
            const reviewDiv = document.getElementById('onboarding-review');
            const categories = onboardingData.geographicCategories.length > 0 
                ? onboardingData.geographicCategories.join(', ') 
                : 'All areas';
            
            reviewDiv.innerHTML = `
                <div style="margin-bottom: var(--space-md);">
                    <strong>Primary Goal:</strong> ${onboardingData.primaryGoal || 'Not selected'}
                </div>
                <div style="margin-bottom: var(--space-md);">
                    <strong>Budget Range:</strong> $${onboardingData.budgetMin.toLocaleString()} - $${onboardingData.budgetMax.toLocaleString()}
                </div>
                <div style="margin-bottom: var(--space-md);">
                    <strong>Family Status:</strong> ${onboardingData.familyStatus || 'Not selected'}
                </div>
                <div style="margin-bottom: var(--space-md);">
                    <strong>Safety Priority:</strong> ${onboardingData.safetyPriority}/10
                </div>
                <div>
                    <strong>Geographic Categories:</strong> ${categories}
                </div>
            `;
        }
        
        function skipOnboarding() {
            // Use default preferences
            onboardingData = {
                primaryGoal: 'Balanced',
                budgetMin: 500000,
                budgetMax: 750000,
                familyStatus: 'Family',
                safetyPriority: 8,
                geographicCategories: 'all',
                onboardingComplete: true
            };
            savePreferences();
        }
        
        function savePreferences() {
            onboardingData.onboardingComplete = true;
            localStorage.setItem('homescorepro_preferences', JSON.stringify(onboardingData));
            applyPreferences();
            hideOnboarding();
        }
        
        function applyPreferences() {
            // Apply preferences to scoring functions
            window.userPreferences = onboardingData;
            
            // Display sample properties when preferences are applied
            displaySampleProperties();
            
            // Update UI based on preferences if needed
            if (onboardingData.geographicCategories === 'all' || 
                (Array.isArray(onboardingData.geographicCategories) && onboardingData.geographicCategories.length === 4)) {
                // All categories selected
            }
        }
        
        // ═══════════════════════════════════════════════════════════════
        // PASSWORD PROTECTED ACCESS FUNCTIONS
        // ═══════════════════════════════════════════════════════════════
        
        const TESTING_PASSWORD = 'Hampz';
        
        function showPasswordModal() {
            const modal = document.getElementById('password-modal');
            modal.classList.add('active');
            document.getElementById('password-input').focus();
        }
        
        function closePasswordModal() {
            const modal = document.getElementById('password-modal');
            modal.classList.remove('active');
            document.getElementById('password-input').value = '';
            document.getElementById('password-error').classList.remove('show');
        }
        
        function checkPassword() {
            const input = document.getElementById('password-input');
            const error = document.getElementById('password-error');
            const password = input.value.trim();
            
            if (password === TESTING_PASSWORD) {
                // Grant paid access
                localStorage.setItem('homescorepro_paid_access', 'true');
                sessionStorage.setItem('homescorepro_paid_access', 'true');
                closePasswordModal();
                enablePaidFeatures();
                alert('Access granted! You now have full paid features for testing.');
            } else {
                // Show error
                error.classList.add('show');
                input.value = '';
                input.focus();
            }
        }
        
        function checkPaidAccess() {
            const hasAccess = localStorage.getItem('homescorepro_paid_access') === 'true' || 
                             sessionStorage.getItem('homescorepro_paid_access') === 'true';
            if (hasAccess) {
                enablePaidFeatures();
            }
        }
        
        function enablePaidFeatures() {
            // Remove search limits
            sessionStorage.removeItem('searchCount');
            sessionStorage.removeItem('suburb_search_count');
            sessionStorage.removeItem('suburb_search_limit');
            
            // Enable unlimited searches and testing mode
            window.hasPaidAccess = true;
            window.testingMode = true;
            
            // Store access in both localStorage and sessionStorage
            localStorage.setItem('homescorepro_paid_access', 'true');
            sessionStorage.setItem('homescorepro_paid_access', 'true');
            
            // Update UI to show paid features are active
            const upgradeLink = document.querySelector('.nav-cta-upgrade');
            if (upgradeLink) {
                upgradeLink.textContent = '✓ Paid Access Active';
                upgradeLink.style.background = 'var(--success)';
                upgradeLink.onclick = function(e) {
                    e.preventDefault();
                    // Allow re-entering password or show current status
                    if (confirm('You have full paid access for testing. All features are unlocked.\n\nClick OK to continue, or Cancel to enter password again.')) {
                        return;
                    } else {
                        showPasswordModal(); // Allow re-entering password
                    }
                };
            }
            
            // Remove search limit messages
            const limitMessage = document.getElementById('search-limit-message');
            if (limitMessage) {
                limitMessage.style.display = 'none';
            }
            
            // Re-enable search button if it was disabled
            const searchBtn = document.getElementById('search-btn');
            if (searchBtn) {
                searchBtn.disabled = false;
            }
            
            // Remove blur from all detailed metrics
            removeBlurFromMetrics();
            
            // Force refresh of any displayed content to show unblurred metrics
            const currentSuburb = document.getElementById('suburb-select')?.value;
            if (currentSuburb) {
                calculateAScore();
            }
        }
        
        // Remove blur from detailed metrics for testing
        function removeBlurFromMetrics() {
            const blurredElements = document.querySelectorAll('.blurred-metrics');
            blurredElements.forEach(el => {
                el.style.filter = 'none';
                el.style.opacity = '1';
                el.style.pointerEvents = 'auto';
                el.style.userSelect = 'text';
            });
        }
        
        // Check if testing mode is active
        function isTestingMode() {
            return window.testingMode || window.hasPaidAccess || 
                   localStorage.getItem('homescorepro_paid_access') === 'true';
        }
    </script>
</body>
</html>
